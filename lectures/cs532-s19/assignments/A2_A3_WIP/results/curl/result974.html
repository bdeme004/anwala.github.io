
<!DOCTYPE html>
<html lang="en" ng-app="app" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="twitter:label1" content="" />
<meta name="twitter:data1" content="Habbi" />
<meta name="twitter:label2" content="" />
<meta name="twitter:data2" content="" primaryCategory": "BUSINESS", " />
<meta property="fb:app_id" content="749967531714191" />
<meta property="og:title" content="Only the Work Remains" />
<meta property="og:description" content="There is no hack. There is just the work." />
<meta name="description" content="There is no hack. There is just the work." />
<meta property="og:image" content="https://media.promogogo.com/habbi/2019-02-26/37069d9a4a5e4448958d95a2eb6f9044.jpeg" />
<meta name="twitter:site" content="@hrefnahelga">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Only the Work Remains">
<meta name="twitter:description" content="There is no hack. There is just the work.">
<meta name="twitter:image" content="https://media.promogogo.com/habbi/2019-02-26/6842319e3e774ef5a1d557e8a58eaaec.jpeg">
<meta property="og:site_name" content="Habbi" />
<meta property="og:type" content="article" />
<link id="favicon" rel="icon" type="image/png" sizes="64x64" href="/styles/promogogo/promo_icon_64px.png">
<link rel="canonical" href="https://habbi.promogogo.com/announcement/Only-the-Work-Remains/041c4b0226394197" />
<meta content="https://habbi.promogogo.com/announcement/Only-the-Work-Remains/041c4b0226394197" property="og:url" />
<title>
    
    
        
            Only the Work Remains
        
        
    
</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, target-densitydpi=medium-dpi, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1118.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script><style type="text/css">
        body, div, dl, dt, dd, ul, ol, li, h1, h2, h3, h4, h5, h6, pre, form, fieldset, input, p, blockquote, th, td {
            margin: 0;
            padding: 0;
        }

        table {
            border-collapse: collapse;
            border-spacing: 0;
        }

        fieldset, img {
            border: 0;
        }

        address, caption, cite, code, dfn, th, var {
            font-style: normal;
            font-weight: normal;
        }

        ol, ul {
            list-style: none;
        }

        caption, th {
            text-align: left;
        }

        h1, h2, h3, h4, h5, h6 {
            font-size: 100%;
        }

        q:before, q:after {
            content: '';
        }
    </style>
<script src="/scripts/3rdparty/jquery/jquery-3.2.1.min.js"></script>
<script src="/scripts/3rdparty/popper.js/1.12.6/umd/popper.min.js"></script>
<script src="/scripts/3rdparty/bootstrap-4.3.0-dist/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/scripts/3rdparty/angular-1.6.2/angular.min.js"></script>
<script type="text/javascript" src="/scripts/3rdparty/angular-1.6.2/angular-animate.min.js"></script>
<script type="text/javascript" src="/scripts/3rdparty/angular-1.6.2/angular-route.min.js"></script>
<script type="text/javascript" src="/scripts/3rdparty/angular-1.6.2/angular-touch.min.js"></script>
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900|Open+Sans+Condensed:300,700|Open+Sans:400,700,800|Raleway|Roboto:300,400,700" rel="stylesheet">
<script type="text/javascript" src="/scripts/promogogo/app/src/imagetest.js?version=20190221T013654000Z"></script>
<link rel="stylesheet" type="text/css" href="/scripts/3rdparty/bootstrap-4.3.0-dist/css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" href="/css/go/mdb.css?version=20190221T013654000Z" />
<link rel="stylesheet" type="text/css" href="/css/go/gogopage.css?version=20190221T013654000Z" />
<script defer src="/scripts/3rdparty/fontawesome-pro-5.5.0-web/js/all.min.js"></script>
<script defer src="/scripts/3rdparty/fontawesome-pro-5.5.0-web/js/v4-shims.min.js"></script>
<script type="text/javascript" src="/scripts/3rdparty/video.js/dist/video.min.js"></script>
<link rel="stylesheet" type="text/css" href="/scripts/3rdparty/video.js/dist/video-js.min.css" />
<script type="text/javascript" src="/scripts/3rdparty/swiper446/dist/js/swiper.min.js"></script>
<link rel="stylesheet" type="text/css" href="/scripts/3rdparty/swiper446/dist/css/swiper.min.css" />
<style type="text/css">
                .theme-hue-24-subset-1 { background-color: #ffffff; }.theme-hue-24-subset-1 h1.banner-title { color: #ffffff !important; }
.theme-hue-24-subset-1 h2.banner-kicker { color: #ffffff !important; }
.theme-hue-24-subset-1 .btn.btn-cta {
    color: #ffffff !important;
    background-color: #e07033 !important;
    border-color: #e07033 !important;
}
.theme-hue-24-subset-1 .btn.btn-cta:hover {
    background-color: #d66629 !important;
    border-color: #d66629 !important;
}
.theme-hue-24-subset-1 .btn.btn-cta:focus {
    background-color: #d66629 !important;
    border-color: #d66629 !important;
}
.theme-hue-24-subset-1 .btn.btn-cta:active {
    background-color: #d66629 !important;
    border-color: #d66629 !important;
}
.theme-hue-24-subset-1 .app .btn {
    color: #ffffff !important;
    background-color: #e07033 !important;
    border-color: #952500 !important;
    box-shadow: 0 0 0 0 !important;
}.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row { background-color: #ffffff; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .banner-text-below h1.banner-title { color: #e07033 !important; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .banner-text-below h2.banner-kicker { color: #e07033 !important; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row h1 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row h2 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row h3 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row h4 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row h5 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row a { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row a:hover { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row a:visited { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .section-tab { border-color: #e07033; background-color: transparent; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .section-tab:hover { background-color: #e07033; color: #ffffff; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .author-name { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .categories a { border-color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .categories a:hover { background-color: #e07033; color: #ffffff }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .link { border-color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .link a { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .link a:hover { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .link a:visited { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .link a i { color: #ffffff; margin-left: 0.5em; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .link-icon { background-color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .next-page a { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .blurb-extra blockquote { border-color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .blurb-extra blockquote:before { background-color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .blurb-extra blockquote:before { color: #ffffff; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .blurb-extra pre { border-color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .blurb-extra pre { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+1) > .row .blurb-extra hr { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row { background-color: #f5f5f5; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .banner-text-below h1.banner-title { color: #e07033 !important; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .banner-text-below h2.banner-kicker { color: #e07033 !important; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row h1 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row h2 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row h3 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row h4 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row h5 { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row a { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row a:hover { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row a:visited { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .section-tab { border-color: #e07033; background-color: transparent; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .section-tab:hover { background-color: #e07033; color: #f5f5f5; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .author-name { color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .categories a { border-color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .categories a:hover { background-color: #e07033; color: #f5f5f5 }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .link { border-color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .link a { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .link a:hover { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .link a:visited { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .link a i { color: #f5f5f5; margin-left: 0.5em; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .link-icon { background-color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .next-page a { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .blurb-extra blockquote { border-color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .blurb-extra blockquote:before { background-color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .blurb-extra blockquote:before { color: #f5f5f5; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .blurb-extra pre { border-color: #e07033; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .blurb-extra pre { color: #565656; }
.theme-hue-24-subset-1 .page-row:nth-of-type(2n+2) > .row .blurb-extra hr { color: #e07033; }
            </style>
<style id="sarala-regular" type="text/css">@font-face {font-family:'Sarala Regular';font-style: normal;font-weight: 400;src: url(//fonts.gstatic.com/s/sarala/v1/ohip9lixCHoBab7hTtgLnw.ttf);}</style>
<style type="text/css">
            
            #gogo-page.gogo-page .textstyletarget h1, #gogo-page.gogo-pageh1.textstyletarget, #gogo-page.gogo-page .textstyletarget h2, #gogo-page.gogo-pageh2.textstyletarget, #gogo-page.gogo-page .textstyletarget h3, #gogo-page.gogo-pageh3.textstyletarget, #gogo-page.gogo-page .textstyletarget h4, #gogo-page.gogo-pageh4.textstyletarget, #gogo-page.gogo-page .textstyletarget h5, #gogo-page.gogo-pageh5.textstyletarget, #gogo-page.gogo-page .textstyletarget h6, #gogo-page.gogo-pageh6.textstyletarget { color: rgb(28, 28, 28); }
            
            #gogo-page.gogo-page h1.banner-title { font-family: "Sarala Regular"; }
            
            #gogo-page.gogo-page h2.banner-kicker { font-family: "Sarala Regular"; }
            
            #gogo-page.gogo-page h1, #gogo-page.gogo-page h2, #gogo-page.gogo-page h3, #gogo-page.gogo-page h4, #gogo-page.gogo-page h5, #gogo-page.gogo-page h6 { font-family: "Sarala Regular"; }
            
            #gogo-page.gogo-page { background-color: rgb(255, 255, 255) !important; font-family: "Sarala Regular"; }
            
            #gogo-page.gogo-page .page-background { background-image: url("https://media.promogogo.com/habbi/2018-06-05/4def95e36535428e88f5579f06720025.jpg") !important; background-position: center center; background-size: cover; }
            
            #gogo-page.gogo-page #rowf83d7377c6ec489d { background-color: rgb(255, 255, 255) !important; }
            
            #gogo-page.gogo-page #row3789ae9e52374aba { background-color: rgb(255, 255, 255) !important; }
            
            #gogo-page.gogo-page #container20c287d3-175d-48c3-811e-cdfabbf33196 { background-color: rgb(252, 252, 252) !important; }
            
        </style>
<script type="text/javascript" src="/scripts/3rdparty/js-cookie/js.cookie.js"></script>
<script type="text/javascript">
        var isDoNotTrack = false;
        var dnt = navigator.doNotTrack;
        if(dnt)
        {
            if(dnt == 1)
            {
                isDoNotTrack = true;
            }
            else
            {
                isDoNotTrack = Cookies.get('notrack');
            }
        }
        else {
            isDoNotTrack = Cookies.get('notrack');
        }
        var thisUri = document.location.href;
        //var thisPageUrl = thisUri.split('?')[0];
        var thisPageUrl = "habbi";
        //var should = thisUri.includes("dynamic");
        var should = isDoNotTrack;
        window.digitalData = {
            "skipCount": should,
            "page": {
                "pageInfo": {
                    "pageID": "041c4b0226394197",
                    "pageName": "Only the Work Remains",
                    "destinationURL": document.location.href,
                    "author": "Habbi",
                    "issueDate": "2018-03-09T15:35:24.000Z", 
                    "publisher": "habbi",
                    "instance": "promogogo",
                    "category": {
                        "primaryCategory": "BUSINESS", 
                        
                    },
                    "attributes": {
                        "posterImage": "https://media.promogogo.com/2019-02-26/9b6a826197904aaabb3d43c3bc7db98f.jpeg",
                        "posterImagearticlelist": "https://media.promogogo.com/2019-02-26/f6f5564df0c5471698b7fc8381dd3305.jpeg",
                        "posterImageDesc": "https://media.promogogo.com/2019-02-26/9b6a826197904aaabb3d43c3bc7db98f.jpeg",
                        "url": "gogoblogpost-jawwg",
                        "seoUrl": "Only-the-Work-Remains",
                        "type": "BLOGENTRY",
                        "pageUrl": thisPageUrl,
                        "referrer": document.referrer,

                    },
                }
            }
        };

        var isMobile = false;

        if (/Android|webOS|iPhone|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent))
        {
            isMobile = true;
        }

    </script>
<script src="/scripts/3rdparty/infinite-scroll.pkgd.min.js"></script>
<script type="text/javascript">
    $(function () {

        var loadinclude = function(target, source, cb) {
            /*
            Wrapper around loading stuff from include.do
            Attempts to place a loading indicator into pagination when present.
            TODO: also show loading indicator for infinite scroll.

            # params
            target: the container that should receive the loaded content
            source: the link do load from (probably include.do)
            cb: callback to run after loading is finished
            */
            $(target).find('.entryNavigation').html('<div class="center pb-4"><i class="fas fa-spinner fa-spin"></i></div>');
            $(target).load(source, function(response, status) {
                if(status==="error") {
                    $(this).empty();
                }
                else if (cb) {
                    cb();
                }
            });
        };

        var buildLink = function(elem, section, category) {
            /*
            Build a link to an endpoint to call from data attributes and other.
            We assume the elem contains the following data attributes:
            source: the base url to load from. Ususally include.do with the page id and
            type of ghetto to load
            offset: optional - the offset to start at (TODO: probably not needed,
            investigate and clean up)
            limit: optional - how many posts to load at a time

            # params
            elem: the element to check
            section: optional - the section name to filter by
            category: optional - the category name to filter by
            */
            var offset = $(elem).data('offset');
            var limit = $(elem).data('limit');
            var source = $(elem).data('source');
            if (offset) {
                source = source + '&offset=' + offset;
            }
            if (limit) {
                source = source + '&limit=' + limit;
            }
            if (section) {
                source = source + '&section=' + encodeURIComponent(section);
            }
            if (category) {
                source = source + '&category=' + encodeURIComponent(category);
            }
            return source
        }

        var init = function(elem, section, category) {
            /*
            Initialise an in-place paginated object.
            */
            source = buildLink(elem, section, category);
            loadinclude(elem, source);
        }

        var initInfinite = function(elem, section, category) {
            /*
            Initialize an infinite scroller
            */
            var source = buildLink(elem, section, category);
            var infiniteContainer = $('<div />');
            infiniteContainer.appendTo(elem);
            var urlPrefix = "";
             urlPrefix = "https://data.promogogo.com" 
            loadinclude(infiniteContainer, source, function() {
                $(infiniteContainer).infiniteScroll({
                                                        path: function() {
                                                            var nextlink = $(infiniteContainer).data('nextlink');
                                                            if (nextlink === undefined) {
                                                                nextlink = urlPrefix + $(infiniteContainer).find('.pnext').attr('href');
                                                                $(infiniteContainer).data('nextlink', nextlink);
                                                            }
                                                            return nextlink;
                                                        },
                                                        history: false,
                                                        append: '.articleincludes',
                                                        hideNav: '.entryNavigation',
                                                    })
                        .on('load.infiniteScroll', function(event, response, path) {
                            var relativeUrl = $(response).find('.pnext').attr('href');
                            var newNextLinkAbsoluteUrl = urlPrefix + relativeUrl;
                            // var newNextLink = $(response).find('.pnext').attr('href');
                            if (!($(infiniteContainer).data('nextlink') === newNextLinkAbsoluteUrl)) {
                                $(infiniteContainer).data('nextlink', newNextLinkAbsoluteUrl);
                            } else {
                                // Reached last page, clear the next link param.
                                $(infiniteContainer).data('nextlink', null);
                            }
                        });
            });
        };

        var reloadInfinite = function(elem, section, category) {
            /*
            Replace the contents of an already initialized infinite scroller with a new
            feed.
            */
            $(elem).find('div').remove();
            initInfinite(elem, section, category);
        }

        function changeQueryParameters(params) {
            var theURL = new  URL(window.location.href);
            for (var query in params) {
                var value = params[query];
                if (value) {
                    theURL.searchParams.set(query, value);
                }
                else {
                    theURL.searchParams.delete(query);
                }
            }

            history.pushState(null, null, theURL.href);
        }

        function handlePopState(event){
            var theURL = new URL(event.target.location.href);
            var theSections;
            var extraID = theURL.searchParams.get('extra');
            var extra = '.articlelist-' + extraID;
            var section = theURL.searchParams.get('section');
            var category = theURL.searchParams.get('category');

            function updateSectionButtonStyle(){

                $(this).removeClass('selected');
                if (section && $(this).data('section') === section) {
                    $(this).addClass('selected');
                }
                if (category && $(this).data('category') === category) {
                    $(this).addClass('selected');
                }
                if (!$(this).data('section') && !$(this).data('category') && !section & !category) { // select ALL button (button has no data-section and no data-category) and there is no category and no section,
                    $(this).addClass('selected');
                }
            }

            if (extraID) {
                if (  $(extra).hasClass('js-includeextra')  ) {
                    init(extra, section, category);
                } else {
                    reloadInfinite(extra, section, category);
                }
                theSections = $(extra).parents('[id*="extra"]').find('.section');
                theSections.each(updateSectionButtonStyle);
            }

            else {
                $('.js-includeextra').each(function() {
                    init(this, section, category);
                    theSections = $(this).parents('[id*="extra"]').find('.section');
                    theSections.each(updateSectionButtonStyle);
                });
                $('.js-infiniteextra').each(function() {
                    extra = '.articlelist-' + $(this).data('extra');
                    console.log('infinite extra;', extra);
                    reloadInfinite(extra, $(this).data('section'), $(this).data('category'));
                });


            }
        }

        $(document).ready(function() {

            /* Set up in-place paginated object */
            $('.js-includeextra').each(function() {
                init(this, $(this).data('section'),  $(this).data('category'));
                $(window).on('popstate', handlePopState);

            }).on('click', 'li.page-item a', function(e) {
                e.preventDefault();
                var extra = this.closest('.js-includeextra');
                if (extra) {
                    loadinclude(extra, this.href, function() {
                        $('html, body').animate({
                                                    scrollTop: $(extra).offset().top - 60
                                                }, 2000)
                    });
                }
            });

            /* Set up an infinite scroller */
            $('.js-infiniteextra').each(function() {
                initInfinite(this, $(this).data('section'), $(this).data('category'));
                $(window).on('popstate', handlePopState);
            });

            $('.collapse').on('shown.bs.collapse', function(e) {
                var $card = $(this).closest('.card');
                if ($card && $card.length > 0) {
                    $('html,body').animate({
                                               scrollTop: $card.offset().top
                                           }, 500);
                }
            });

            $('.section').on('click', function() {
                var section;
                var category;
                var extraID = $(this).data('extra');
                var isSelected = $(this).hasClass('selected');
                var extra = '.articlelist-' + extraID;
                if (!isSelected) {
                    section = $(this).data('section');
                    category = $(this).data('category');
                    $('.section').each(function() {
                        $(this).removeClass("selected");
                    })
                    $(this).addClass("selected");
                } else {
                    $(this).removeClass("selected");
                }

                changeQueryParameters({
                                          section: section,
                                          category: category,
                                          extra: extraID
                                      });

                if ($(extra).hasClass("js-includeextra")) {
                    init(extra, section, category);
                }
                else {
                    reloadInfinite(extra, section, category);
                    console.log('extra', extra);
                }
            });
        });
    });

</script>
</head>
<body class="gogo-page theme-hue-24-subset-1 041c4b0226394197" id="gogo-page">

<div class="alert alert-warning cookie-alert m-0 w-100" role="alert">
<div class="d-md-flex align-items-center">
<div class="center">Promogogo uses cookies for functionality.
<a href="https://dashboard.promogogo.com/poster/Cookie-Policy-Promogogo/75e7a976084840d3" target="_blank">
<i class="far fa-info-circle"></i>
<span class="d-none d-md-inline">
Learn more
</span>
</a>
</div>
<div class="ml-auto d-flex d-md-block justify-content-center align-items-center">
<button type="button" class="btn btn-primary btn-md m-0 acceptcookies" aria-label="Close">
OK<span class="d-none d-md-inline">, that's cool</span>
</button>
<a href="" class="denycookies ml-2" target="_blank">
<i class="far fa-ban"></i> Count me out
</a>
</div>
</div>
</div>
<div class="container-fluid gogo-page-display slideshow-target gogo-page " device="web">
<div class="page-background background-container"></div>
<div class="pbcontainer container      " id="container20c287d3-175d-48c3-811e-cdfabbf33196">
<div class="container-background background-container">
</div>
<div class="row-container page-row style-item  row-posterback  ">
<div id="rowf83d7377c6ec489d" class="row no-gutters full-width ">
<div class="row-background background-container"></div>
<div id="coldf95c814794e4d77" class="col-12 col-md col   page-column ">
<div class="column-background background-container"></div>
<div class="">
<div class="extra-container banner-container">
<div class="banner-extra page-extra style-item " id="extra684407ee821244b8">
<div class="extra-background background-container"></div>
<div class="banner banner-50701905">
<div class="banner-image crop-wide jarallax" data-jarallax style="background-image: url(https://media.promogogo.com/habbi/2019-02-26/7aef45f80abb4871a5aa4924196cf361.jpg)" desktop-image="background-image: url(https://media.promogogo.com/habbi/2019-02-26/7aef45f80abb4871a5aa4924196cf361.jpg)" desktop-crop-key="wide" mobile-image="background-image: url(https://media.promogogo.com/habbi/2019-02-26/e5005a1bf3804ef29552fd68ab38b1b0.jpg)" mobile-crop-key="mobile-narrow">
</div>
<div class="banner-overlay">
<div class="banner-text banner-text-bottom banner-text-right">
<h1 class="banner-title">Only the Work Remains</h1>
<h2 class="banner-kicker"></h2>
<div class="banner-blurb textstyletarget linkstyletarget"></div>
</div>
</div>
</div>
<div class="banner-credit">
<div class="credit-extra  textstyletarget linkstyletarget" id="extranull">
<div class="credit-item">
<span class="credit-title">banner by </span>
<a target="_blank" href="https://unsplash.com/photos/3iT3dnmblGE" class="credit-link">Mikayla Mallek</a>
&nbsp;
</div>
<div class="credit-item">
<span class="credit-title">and screengrab and quote from </span>
<a target="_blank" href="https://www.youtube.com/watch?v=GOiIxqcbzyM&amp;t=74s" class="credit-link">cgp grey on youtube</a>
&nbsp;
</div>
</div>
</div>
</div>
</div>
</div>
</div> 
</div> 
</div> 
<div class="row-container page-row style-item  row-posterback  ">
<div id="rowf485c060-1779-4587-bdaf-53e1a421cd36" class="row no-gutters ">
<div class="row-background background-container"></div>
<div id="col8638c50a-56ae-45c0-94d7-cacebb6963ee" class="col-12 col-md col   page-column ">
<div class="column-background background-container"></div>
<div class="">
<div class="extra-container blurb-container">
<div class="blurb-extra page-extra style-item " id="extra881c5163c0ba4d87">
<div class="extra-background background-container"></div>
<div class="pbblurb pbblurb-image-top pbblurb-title-center is-readable contentbackground textstyletarget linkstyletarget">
<div class="pbblurb-content">
<div class="content">
<p>The most interesting thing about our era where technical barriers have been wiped away for so many things, is that the focus is exclusively on the work. When you can make websites without knowing how to code the question is not â€œhow do I make a website?â€, but â€œwhat should my website say?â€.</p>
<p>I see this with making Promogogo. We make it easy for people to build campaigns that work really well on social. What used to be a treacherous nightmare zone is now as basic as writing a Facebook post.</p>
<p>So our conversations with our users pause briefly on the technical question but move straight into strategy, branding and how to run campaigns well. How to reach people. How to build an audience.</p>
<h3>from Technical Barriers to Understanding People</h3>
<p>With services like Teespring and more where anyone can create a t-shirt business without any logistical considerations. The <a href="https://thehustle.co/profiting-on-teespring" target="_blank">question</a> becomes â€œwhat kinda of t-shirts do people want to buy?â€.</p>
<p>My three youngest siblings are all of the â€˜Gen Zâ€ generation. They were talking about some cool new fashion brand, as teenagers do, that someone from the local community had started and completely exploded in trendiness. I asked them: â€œwhat do you think is the hardest thing about running a business in fashion?â€ and all of them, in unison, without question answered the same thing: â€œthe brandingâ€.</p>
<p>Hailley and I had this with the podcast. We bought $80 mics on Amazon, we call using Skype and some call recorder, and I edit in GarageBand. It still took us over a year to get it out the door; because it wasnâ€™t right. We threw out the first two or three episodes before we found our groove.</p>
<p>We hadnâ€™t done the work yet. <br><strong>We had to develop our tone, our brand, our story, our work first.</strong></p>
<p>So the only barrier to making and launching a podcast then becomes setting aside the time to record and edit it. That's the only one. There are no other ones. There are not financial ones, there are no gatekeepers, the level of technical skills you need are so basic if you're reading this right now on the internet, you already have all the skills you need.</p>
<h3>Doing the work doesnâ€™t just come first. <br>There is nothing without the work.</h3>
<p>This is why â€˜growth hacksâ€ and â€˜life hacksâ€ bore me. <br>There is no hack. There is just the work.</p>
<p>Musicians ask me how to get on Spotify Playlists, how to get a million views on YouTube, how to build their Twitter followers.</p>
<p>You wanna know how? Write a good fucking song. <br>Go play it somewhere. Make sure those who listen know your name.<br>Keep doing it until something sticks.</p>
<p>Every success story in the music industry starts with either a YouTube video, or "came across them playing some tiny stinky basement" â€ but they were doing the work. They were out there: performing, singing, writing, sharing.</p>
<p>In the publishing industry, <strong>you have to have written the whole book </strong>before you can get a booking agent. And you can't get a book deal without a booking agent. <strong>You need to write the whole book first. </strong>That seriously blows my mind. Like I thought you'd be signed and then like get some payments up front, and an editor you can be like "hey, which version is better??" you could back and forth with.</p>
<p>Nah. Doesn't work that way. Gotta write the whole thing first. <br></p>
</div>
</div>
</div>
<script type="text/javascript">
            $(document).ready(function() {
                var thisBlurb = $("#extra881c5163c0ba4d87");
                var target = $(window);

                thisBlurb.find(".tw-quote-btn").click(function(evt) {
                    evt.preventDefault();
                    var articleURL = location.href;

                    var quote = $($(evt.target).parents('blockquote')[0]).find('.quote-text').text();
                    var twitterText = $($(evt.target).parents('blockquote')[0]).find('.twitter-text').text() || quote;
                    
                    var width  = Math.min(575, target.width()),
                            height = 400,
                            left   = (target.width()  - width)  / 2,
                            top    = (target.height() - height) / 2,
                            url    =  'http://twitter.com/share' + "?text=" + encodeURIComponent(twitterText) + "&url=" + encodeURIComponent(articleURL),
                            opts   = 'status=1' +
                                     ',width='  + width  +
                                     ',height=' + height +
                                     ',top='    + top    +
                                     ',left='   + left;

                    window.open(url, 'twitter', opts);

                    return false;
                });

                thisBlurb.find(".fb-quote-btn").click(function(evt) {
                    evt.preventDefault();
                    var quote = $($(evt.target).parents('blockquote')[0]).find('.quote-text').text();

                    var url = 'https://www.facebook.com/sharer/sharer.php' +
                              "?app_id=472756216419966&sdk=joey&display=popup&ref=plugin&src=share_button" +
                              
                              "&quote=" + encodeURIComponent(quote);



                    window.open(url, 'Facebook', 'width=640,height=580');

                    return false;
                });
            });
        </script>
<script id="twitter-wjs" type="text/javascript" async defer src="//platform.twitter.com/widgets.js"></script>
</div>
</div>
</div>
<div class="">
<div class="extra-container blurb-container">
<div class="blurb-extra page-extra style-item " id="extra34f0ac681b464d58">
<div class="extra-background background-container"></div>
<div class="pbblurb pbblurb-image-top pbblurb-title-center is-readable contentbackground textstyletarget linkstyletarget">
<div class="pbblurb-content">
<div class="content">
<h3>The work builds a following, itâ€™s not the other way around.</h3>
<figure><img src="https://media.promogogo.com/2018-03-09/cc3cbedea83648028a9c43a40a002d97.png" data-image="jcd6a12gyzjq"></figure>
<p>In the words of <a href="https://www.youtube.com/watch?v=GOiIxqcbzyM&t=74s" target="_blank">someone</a> much smarter than me:</p>
<blockquote><strong>What's the best way to be successful on YouTube?</strong><br>Make videos people want to watch. <br><br>Iâ€™m not trying to be glib here but when asked this question I see many YouTubers talk about the importance of upload schedules and managing your social media and collaborations and my experience says that's completely backwards. <br> <br>If your videos aren't interesting no one will care if you upload them regularly and <strong>Twitter followers don't get you views, views gets you Twitter followers</strong> and people who want to collaborate with you.<br> <br>I know it's not very helpful advice but it's the most truthful advice I can give.</blockquote>
</div>
</div>
</div>
<script type="text/javascript">
            $(document).ready(function() {
                var thisBlurb = $("#extra34f0ac681b464d58");
                var target = $(window);

                thisBlurb.find(".tw-quote-btn").click(function(evt) {
                    evt.preventDefault();
                    var articleURL = location.href;

                    var quote = $($(evt.target).parents('blockquote')[0]).find('.quote-text').text();
                    var twitterText = $($(evt.target).parents('blockquote')[0]).find('.twitter-text').text() || quote;
                    
                    var width  = Math.min(575, target.width()),
                            height = 400,
                            left   = (target.width()  - width)  / 2,
                            top    = (target.height() - height) / 2,
                            url    =  'http://twitter.com/share' + "?text=" + encodeURIComponent(twitterText) + "&url=" + encodeURIComponent(articleURL),
                            opts   = 'status=1' +
                                     ',width='  + width  +
                                     ',height=' + height +
                                     ',top='    + top    +
                                     ',left='   + left;

                    window.open(url, 'twitter', opts);

                    return false;
                });

                thisBlurb.find(".fb-quote-btn").click(function(evt) {
                    evt.preventDefault();
                    var quote = $($(evt.target).parents('blockquote')[0]).find('.quote-text').text();

                    var url = 'https://www.facebook.com/sharer/sharer.php' +
                              "?app_id=472756216419966&sdk=joey&display=popup&ref=plugin&src=share_button" +
                              
                              "&quote=" + encodeURIComponent(quote);



                    window.open(url, 'Facebook', 'width=640,height=580');

                    return false;
                });
            });
        </script>
<script id="twitter-wjs" type="text/javascript" async defer src="//platform.twitter.com/widgets.js"></script>
</div>
</div>
</div>
</div> 
</div> 
</div> 
<div class="row-container page-row style-item  row-posterback  ">
<div id="row3789ae9e52374aba" class="row no-gutters ">
<div class="row-background background-container"></div>
<div id="colf935628e85f94448" class="col-12 col-md-2 col   page-column ">
<div class="column-background background-container"></div>
<div class="">
<div class="extra-container blurb-container">
<div class="blurb-extra page-extra style-item " id="extrac1ffd0e20e5a417d">
<div class="extra-background background-container"></div>
<div class="pbblurb  is-readable contentbackground textstyletarget linkstyletarget">
<div class="pbblurb-content">
</div>
</div>
<script type="text/javascript">
            $(document).ready(function() {
                var thisBlurb = $("#extrac1ffd0e20e5a417d");
                var target = $(window);

                thisBlurb.find(".tw-quote-btn").click(function(evt) {
                    evt.preventDefault();
                    var articleURL = location.href;

                    var quote = $($(evt.target).parents('blockquote')[0]).find('.quote-text').text();
                    var twitterText = $($(evt.target).parents('blockquote')[0]).find('.twitter-text').text() || quote;
                    
                    var width  = Math.min(575, target.width()),
                            height = 400,
                            left   = (target.width()  - width)  / 2,
                            top    = (target.height() - height) / 2,
                            url    =  'http://twitter.com/share' + "?text=" + encodeURIComponent(twitterText) + "&url=" + encodeURIComponent(articleURL),
                            opts   = 'status=1' +
                                     ',width='  + width  +
                                     ',height=' + height +
                                     ',top='    + top    +
                                     ',left='   + left;

                    window.open(url, 'twitter', opts);

                    return false;
                });

                thisBlurb.find(".fb-quote-btn").click(function(evt) {
                    evt.preventDefault();
                    var quote = $($(evt.target).parents('blockquote')[0]).find('.quote-text').text();

                    var url = 'https://www.facebook.com/sharer/sharer.php' +
                              "?app_id=472756216419966&sdk=joey&display=popup&ref=plugin&src=share_button" +
                              
                              "&quote=" + encodeURIComponent(quote);



                    window.open(url, 'Facebook', 'width=640,height=580');

                    return false;
                });
            });
        </script>
<script id="twitter-wjs" type="text/javascript" async defer src="//platform.twitter.com/widgets.js"></script>
</div>
</div>
</div>
</div> 
<div id="col232c922cc7ff4132" class="col-12 col-md col   page-column ">
<div class="column-background background-container"></div>
<div class="">
<div class="extra-container blurb-container">
<div class="blurb-extra page-extra style-item " id="extra42a22b79765f4bc6">
<div class="extra-background background-container"></div>
<div class="pbblurb  is-readable contentbackground textstyletarget linkstyletarget">
<div class="pbblurb-content">
<div class="content">
<h3>Write, Publish, Repeat</h3>
<p>Communicate clearly who you are. <br>What you are about. Post it where people can find it.</p>
<p>How do you start a blog? Write. <br>Write stories people care about. <br>Keep writing. Keep sharing. <br>Keep doing it. Do the work.</p>
<h3>There is no hack. <br>There is just the work.</h3>
</div>
</div>
</div>
<script type="text/javascript">
            $(document).ready(function() {
                var thisBlurb = $("#extra42a22b79765f4bc6");
                var target = $(window);

                thisBlurb.find(".tw-quote-btn").click(function(evt) {
                    evt.preventDefault();
                    var articleURL = location.href;

                    var quote = $($(evt.target).parents('blockquote')[0]).find('.quote-text').text();
                    var twitterText = $($(evt.target).parents('blockquote')[0]).find('.twitter-text').text() || quote;
                    
                    var width  = Math.min(575, target.width()),
                            height = 400,
                            left   = (target.width()  - width)  / 2,
                            top    = (target.height() - height) / 2,
                            url    =  'http://twitter.com/share' + "?text=" + encodeURIComponent(twitterText) + "&url=" + encodeURIComponent(articleURL),
                            opts   = 'status=1' +
                                     ',width='  + width  +
                                     ',height=' + height +
                                     ',top='    + top    +
                                     ',left='   + left;

                    window.open(url, 'twitter', opts);

                    return false;
                });

                thisBlurb.find(".fb-quote-btn").click(function(evt) {
                    evt.preventDefault();
                    var quote = $($(evt.target).parents('blockquote')[0]).find('.quote-text').text();

                    var url = 'https://www.facebook.com/sharer/sharer.php' +
                              "?app_id=472756216419966&sdk=joey&display=popup&ref=plugin&src=share_button" +
                              
                              "&quote=" + encodeURIComponent(quote);



                    window.open(url, 'Facebook', 'width=640,height=580');

                    return false;
                });
            });
        </script>
<script id="twitter-wjs" type="text/javascript" async defer src="//platform.twitter.com/widgets.js"></script>
</div>
</div>
</div>
</div> 
</div> 
</div> 
<div class="row-container page-row style-item  row-posterback  ">
<div id="row4a916adb691f444d" class="row no-gutters ">
<div class="row-background background-container"></div>
<div id="col46b875a91d1a454b" class="col-12 col-md col   page-column ">
<div class="column-background background-container"></div>
<div class="">
<div class="author-extra d-flex " id="extraed3cb048547f47c0">
<div class="author-box textstyletarget linkstyletarget">
<div class="w-100">
<hr class="" style="" />
</div>
<div class="d-flex">
<div>
<div class="author-image" style="background-image: url(https://media.promogogo.com/habbi/2018-03-09/05d27870e43b4672b21756b2e403af9d.jpg)"></div>
</div>
<div class="author-text ">
<div class="author-title">tell me what I&#39;m missing</div>
<div class="author-description">Hrefna HelgadÃ³ttir (Habbi)</div>
<div class="author-links">
<a class="author-link author-fb" href="https://www.facebook.com/hrefnahelga" target="_blank">facebook</a>
<a class="author-link author-tw" href="https://twitter.com/HrefnaHelga" target="_blank">twitter</a>
<a class="author-link author-insta" href="https://www.instagram.com/habbihelga/" target="_blank">instagram</a>
<a class="author-link author-web" href="http://cosimhabbi.com" target="_blank">web</a>
</div>
</div>
</div>
</div>
</div>
</div>
</div> 
</div> 
</div> 
<div class="row-container page-row style-item  row-posterback  ">
<div id="rowab8496e2cb764fd3" class="row no-gutters ">
<div class="row-background background-container"></div>
<div id="col284e546b5c20431e" class="col-12 col-md col   page-column ">
<div class="column-background background-container"></div>
<div class="">
<div id="extra9ce418cce97a4b6b">
<div id="extra9ce418cce97a4b6b-nextpage">
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $.getJSON("/p/ajax/nextarticle.do?site=habbi&guid=041c4b0226394197", function (data) {
            var d = data;
            var r = "";

            if (d.nextPageGuid)
            {
                var url = "/announcement/" + d.nextPageSEO + "/" + d.nextPageGuid;
                var nextPageTitle = d.nextPageTitle;
                if (d.nextPageImage)
                {
                    r = $("<div class=\"row no-gutters page-row next-page\" style=\"background-image: url('" + d.nextPageImage + "')\"><a href=\"" + url + "\"><div class=\"next-overlay\"><div class=\"next-page-text next-page-text-white\"><div>Next up:</div><div class=\"next-page-title\">" + nextPageTitle + " </div></div></a></div>");
                }
            }
            if (r)
            {
                r.appendTo("#extra9ce418cce97a4b6b-nextpage");
            }
        });

    });
</script>
</div>
</div>
</div> 
</div> 
</div> 
</div>
</div>
</div>
<script type="text/javascript">
    (function () {
        "use strict";

        var cookieAlert = document.querySelector(".cookie-alert");
        var acceptCookies = document.querySelector(".acceptcookies");
        var dontTrack = document.querySelector(".denycookies");

        cookieAlert.offsetHeight; // Force browser to trigger reflow (https://stackoverflow.com/a/39451131)

        if (!isDoNotTrack && !Cookies.get("acceptCookies")) {
            cookieAlert.classList.add("show");
        }

        acceptCookies.addEventListener("click", function () {
            Cookies.set("acceptCookies", true,
                        {
                            domain: window.location.hostname,
                            expires: 365
                        });
            cookieAlert.classList.remove("show");
        });

        dontTrack.addEventListener("click", function () {
            Cookies.set("notrack", true,
                        {
                            domain: window.location.hostname,
                            expires: 365
                        });
            cookieAlert.classList.remove("show");
        });

    })();
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $(document).on("click", ".ctatrackandsend", function (e) {
            e.preventDefault();
            var dest = $(this).attr('href');
            var position = $(this).attr('position');
            var action = $(this).attr('action');
            var target = $(this).attr('target');
            var title = $(this).text();

            var pggTrackData = {
                ver: "1.0",
                tracked: "ctatrackandsend",
                faceUrl: "habbi",
                instance: "promogogo",
                guid: "041c4b0226394197",
                position: position,
                action: action,
                title: title,
                digitalData
            };
            if(!isDoNotTrack)
            {
                var xhr = new XMLHttpRequest();
                xhr.open("POST", "https://count.promogogo.com/ctav1");
                xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                xhr.send(JSON.stringify(pggTrackData));
            }


            setTimeout(function () {
                if (target === '_blank')
                {
                    var success = window.open(dest);
                    if (!success) {
                        window.location = dest;
                    }
                }
                else
                {
                    window.location = dest;
                }
            }, 1000);


        });

        $(document).on("click", ".ctatrack", function (e) {
            e.preventDefault();
            var position = $(this).attr('position');
            var action = $(this).attr('theaction');
            var target = $(this).attr('target');
            var title = $(this).text();

            var pggTrackData = {
                ver: "1.0",
                tracked: "ctatrack",
                faceUrl: "habbi",
                instance: "promogogo",
                guid: "041c4b0226394197",
                position: position,
                action: action,
                title: title,
                digitalData
            };
            if(!isDoNotTrack)
            {
                var xhr = new XMLHttpRequest();
                xhr.open("POST", "https://count.promogogo.com/ctav1");
                xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                xhr.send(JSON.stringify(pggTrackData));
            }



        });



        $('.instagram-link').each(function () {
            var link = $(this);
            var image = link.find("img")[0];
            if (image)
            {
                image.onload = function () {
                    var img = $(this);

                    var credit = $('<a>', {
                        text: link.attr("data-owner"),
                        href: link.attr("href"),
                        'class': "image-credit",
                        target: "_blank"
                    });

                    credit.appendTo(img.parent());
                    var pos = credit.position();

                    credit.css({
                                   top: (pos.top - credit.height()) + "px",
                                   left: (pos.left - credit.outerWidth()) + "px"
                               });
                };
                if (image.complete)
                {
                    image.onload();
                }
            }
        });

        /* pbphoto zoom handling. */
        $(document).on('click', '.js-imagezoom', function (evt) {
            var url = $(this).data('altsrc');
            evt.preventDefault();
            $('#photoExtraModal .modal-body .pbphoto-modal-container').html("<img src='" + url + "'/>");
            $('#photoExtraModal').modal('show', {backdrop: 'static'});
        });
    });

    var goToSection = function (section) {
        var url;
        
        url = "/?section=" + encodeURIComponent(section);
        
        
        window.location.href = window.location.origin + url;
    };

    function animate()
    {
        /*$animation_elements = $('.roll-up');
        $window.trigger('scroll');*/
    }

</script>
<div id="photoExtraModal" class="modal fade" role="dialog">
<div class="modal-dialog pbphoto-modal">
<div class="modal-content">
<div class="modal-body">
<button type="button" class="pbphoto-modal-close" data-dismiss="modal" aria-hidden="true">
&times;
</button>
<div class="pbphoto-modal-container">
Loading...
</div>
</div>
</div>
</div>
</div>
<script type="text/ng-template" id="postsearch/result/list.html">
    <div>
        <div class="result-list searchlist justify-content-center px-2 pt-0 pb-2">
            <div ng-show="items.length" class="w-100">
                <div class="result-item" ng-repeat="item in items"></div>
                <button class="btn btn-primary" ng-if="nextOffset" ng-click="getMoreItems()">GET MORE</button>
            </div>
            <div ng-show="status.ready && !items.length"> We didn't find anything.  Try a different search. </div>

        </div>
    </div>
</script>
<script type="text/ng-template" id="postsearch/result/card.html">
    <div class="searchcardlist">
        <a class="cardurl" href="{{ item.ghettotype === 'blogentry' ? '/announcement' : '/poster' }}/{{item.seourl || item.url}}/{{item.guid}}">
            <div class="card d-flex">
                <div class="d-block align-items-start">
                    <div class="card-image" style="background-image: url('{{item.imageurl}}')">

                    </div>
                    <div class="card-body">
                        <div class="gc-detail-section" ng-show="item.sponsored || item.section">
                            {{item.sponsored ? 'sponsored' : item.section}}
                        </div>
                        <h2 class="card-title">{{item.title}}</h2>
                        <div class="card-kicker">{{item.subtitle}}</div>
                        <div  ng-if="item.author" class="card-author">{{item.author}}</div>
                    </div>
                </div>
            </div>
        </a>
    </div>
</script>
<script type="text/ng-template" id="postsearch/result/column.html">
    <div class="columnsearchlist">
        <a class="cardurl" href="{{ item.ghettotype === 'blogentry' ? '/announcement' : '/poster' }}/{{item.seourl || item.url}}/{{item.guid}}">
            <div class="card d-flex">
                <div class="media">
                    <div class="card-image" style="background-image: url('{{item.imageurl}}')">

                    </div>
                    <div class="card-body">
                        <div class="gc-detail-section" ng-show="item.sponsored || item.section">
                            {{item.sponsored ? 'sponsored' : item.section}}
                        </div>
                        <h2 class="card-title">{{item.title}}</h2>
                        <div class="card-kicker">{{item.subtitle}}</div>
                        <div  ng-if="item.author" class="card-author">{{item.author}}</div>
                    </div>
                </div>
            </div>
        </a>
    </div>
</script>
<script type="text/ng-template" id="postsearch/result/overlay.html">
    <div class="overlaysearchlist">
        <a class="cardurl" href="{{ item.ghettotype === 'blogentry' ? '/announcement' : '/poster' }}/{{item.seourl || item.url}}/{{item.guid}}">
            <div class="card d-flex">
                <div class="media">
                    <div class="card-image" style="background-image: url('{{item.imageurl}}')">

                    </div>
                    <div class="card-body">
                        <div class="gc-detail-section" ng-show="item.sponsored || item.section">
                            {{item.sponsored ? 'sponsored' : item.section}}
                        </div>
                        <h2 class="card-title">{{item.title}}</h2>
                        <div class="card-kicker">{{item.subtitle}}</div>
                        <div  ng-if="item.author" class="card-author">{{item.author}}</div>
                    </div>
                </div>

            </div>
        </a>
    </div>
</script>
<script>
    (function(angular){

        'use strict';

        angular.module("postsearch.module", [])
                .factory("postsearch.service", searchService)
                .directive("postSearchInput", postSearchInput)
                .directive("postSearchContainer", postSearchContainer)
                .directive("searchCard", searchCard);
                // .directive('emitLastRepeaterElement', function() {
                //     return function(scope, element, attrs) {
                //         if (scope.$last) {
                //             scope.$emit('LastRepeaterElement');
                //             scope.$emit("last-repeater-element", element, attrs);
                //         }
                //     };
                // })
                // .filter("titleHtml", ['$sce', function ($sce)
                // {
                //     return function (val)
                //     {
                //         return $sce.trustAsHtml(val);
                //     };
                // }]);

        searchService.$inject = ["$http", "$q"];

        function searchService(http, q) {
            var service = {
                getSearchRequest : getSearchRequest
            };

            return service;

            // - - -

            function getSearchRequest(entry, attrs, offset) {
                var url = attrs.requestBaseUrl;
                var params = eval("("+attrs.requestFixedParameters+")") || {};
                params[attrs.requestSearchParameter] = entry;

                if (!entry ) {
                    return Promise.resolve({suggestions: [], response: {}})
                }
                if (offset) {
                    params.offset = offset;
                }
                var abort = q.defer();

                // create a generic request object
                var requestObj = {
                    url: url,
                    params : params,
                    timeout : abort.promise,
                    method: 'GET',
                    data: attrs.requestData
                };

                // allow for configuration to POST data or set headers
                var requestConfig = eval("(" + attrs.requestConfig + ")") || {};
                for (var key in requestConfig) {
                    requestObj[key] = requestConfig[key];
                }
                var request = http(requestObj);

                var promise = request
                    .then(function(response) {
                        // checks if mapping will resolve

                        function checkMapping(mapping, base) {
                            if (!mapping) return false;
                            var path = mapping.split('.');
                            for ( var i = 0; i < path.length; i++ ) {
                                if (base[path[i]]) {
                                    base = base[path[1]];
                                } else {
                                    return false;
                                }
                                return true;
                            }
                        }

                        // default is returning the responose data
                        var suggestions = response.data;

                        var wholeResponse = response.data; // adds property for the whole response

                        // use response-mapping attribute to map to a different property
                        if( checkMapping(attrs.responseMapping, response.data) ) {  // check if responseMapping will resolve, not just whether there is a responseMapping attr.
                            suggestions = eval( "response.data." + attrs.responseMapping );
                        }


                        return {suggestions : suggestions, response: wholeResponse};  // return object with suggestions and the whole response
                    }, function (error)
                    {
                        console.log('error', error);
                        // we end up here on abort, so return an empty list
                        return {suggestions: [], response: {}}; // mirrors successfull response without data.
                    });
                promise.abort = function ()
                {
                    abort.resolve();
                };

                promise.finally = function ()
                {
                    //cleanup
                    promise.abort = angular.noop;
                    promise = abort = request = params = url = null;
                };

                return promise;
            }
        }


        postSearchInput.$inject = ["$compile", "$templateCache", "$timeout"];

        function postSearchInput(compile, cache, timeout)
        {
            var directive = {
                scope : true,
                link : link,
                controller : SearchController
            };

            return directive;

            // - - -

            function link(scope, element, attrs)
            {
                scope.items = [];
                scope.$list = null;
                scope.status = {
                    busy : false,
                    ready : false,
                    limit : 0
                };
                scope.element = element;

                activate();

                scope.searchOnChange = function(model) {
                    if (!model.length) {
                        scope.items = [];
                        scope.nextOffset = '';
                        scope.totalItems = 0;
                        scope.status.ready = false;
                    }
                    if( model.length > scope.status.limit ) {
                        if ( scope.page ) {scope.page.searchpage = 1;}
                        if ( scope.offset ) {scope.offset.curr = 0}
                        search();
                    }
                }

                var clearBtn = angular.element(element.parent().find('.search-cancel'));
                clearBtn.on('click', clearSearch);

                scope.$on('clear-search', clearSearch);

                scope.getMoreItems = function () {
                    getMore();
                };

                scope.$on('post-begin-search', function(event) {
                    if (element[0].value.length > scope.status.limit) {
                        search();
                    }
                });

                scope.$on('post-begin-update', function(event, ready) {
                    scope.status.ready = ready;
                    update();
                });

                scope.$on("post-search-suggestions", function(evt, responseData) {
                    scope.items = responseData.suggestions;
                    scope.nextOffset = evaluateMapping(attrs.nextOffsetMapping, responseData.response) ? eval("responseData.response." + attrs.nextOffsetMapping) : null;
                    scope.totalItems = evaluateMapping(attrs.totalItemsMapping, responseData.response) ? eval("responseData.response." + attrs.totalItemsMapping) : null;

                    scope.$emit('search-data-returned', responseData.response, attrs); // emits whole response from search and attributes
                    scope.status.ready = true;
                    scope.status.busy = false;

                    update();
                });

                scope.$on("post-more-suggestions", function(evt, responseData) {
                    if (responseData.suggestions.length)
                    {
                        responseData.suggestions.forEach(function (item) {
                            scope.items.push(item);
                        })
                    }

                    scope.nextOffset = evaluateMapping(attrs.nextOffsetMapping, responseData.response) ? eval("responseData.response." + attrs.nextOffsetMapping) : null;
                    scope.totalItems = evaluateMapping(attrs.totalItemsMapping, responseData.response) ? eval("responseData.response." + attrs.totalItemsMapping) : null;

                    scope.$emit('search-data-returned', responseData.response, attrs); // emits whole response from search and attributes
                    scope.status.busy = false;
                    update();
                });

                scope.selectItem = function(item) {
                    scope.status.ready = false;
                    update();
                    var expr = attrs.selectedItem;
                    if( expr ) {
                        scope.tmpSearchSelctedItemXYZ = item;
                        expr += "=tmpSearchSelctedItemXYZ";
                        scope.$eval(expr);
                        delete scope.tmpSearchSelctedItemXYZ;
                    }
                    scope.$emit("post-search-item", item);
                };

                function update() {
                    scope.$list
                        .css({
                            display : scope.status.ready ? "" : "none"
                        });
                }

                function search() {
                    scope.status.busy = true;
                    scope.$eval(attrs.selectedItem + "=null");
                    scope.$emit("post-search-get-suggestions", element.val() );
                }

                function evaluateMapping(pathStr, base)
                {
                    if (!base || !pathStr) return false;
                    var path = pathStr.split('.');
                    for (var i = 0; i < path.length; i++)
                    {
                        if (base[path[i]])
                        {
                            base = base[path[1]];
                        }
                        else
                        {
                            return false;
                        }
                        return true;
                    }
                }

                function getMore() {
                    scope.status.busy = true;
                    if (scope.nextOffset) {
                        scope.$emit("post-more-get-suggestions", element.val(), scope.nextOffset);
                    }
                }
                function clearSearch() {
                    element.val('');
                    scope.items = [];
                    scope.nextOffset = '';
                    scope.totalItems = 0;
                    scope.status.ready = false;
                    scope.$apply();
                }

                function activate() {
                    scope.status.limit = parseInt(attrs.inputLimit) || 0;
                    var result = $(cache.get(attrs.listTemplateUrl));
                    if( attrs.inputSpinner === "false" ) {
                        result.find(".input-spinner").remove();
                    }
                    var list = scope.$list = result.find("div.result-list");
                    list.addClass(attrs.resultClass ? attrs.resultClass : "dropdown-menu");
                    var template = $(cache.get(attrs.resultTemplateUrl));
                    var resultItem = list.find("div.result-item");
                    resultItem.append(template);

                    var container = angular.element(document).find(attrs.resultPlacementSelector);
                    container.append(result);
                    compile(result)(scope);

                    scope.$emit("post-search-view-ready", attrs);
                    if( attrs.requestSearchValue ) {
                        element.val(attrs.requestSearchValue);
                        search();
                    }
                }
            }
        }

        SearchController.$inject = ["$scope", "postsearch.service", "$window"];

        function SearchController(scope, service, $window) {
            var _attrs = {}, _request = null;

            scope.isMobile = $window.isMobile;

            scope.submitTest = function($event, value) {
                if ($event.keyCode === 13) {
                    // console.log('enter!!!');
                    // Is this function only for debugging?
                }
            }

            scope.$on("post-search-view-ready", function(evt, attrs) {
                _attrs = attrs;
            });

            scope.$on('post-more-get-suggestions', function(evt, entry, offset) {
                if (_request) {
                    _request.abort();
                }
                scope.$emit('search-updating')
                (_request = service.getSearchRequest(entry, _attrs, offset)).then(function(suggestions) {
                    scope.$broadcast("post-more-suggestions", suggestions);
                    _request = null;
                    scope.$emit('search-complete');
                });
            })

            scope.$on("post-search-get-suggestions", function(evt, entry) {
                if( _request ) {
                    _request.abort();
                }

                (_request = service.getSearchRequest(entry, _attrs)).then(function(suggestions) {
                    scope.$broadcast("post-search-suggestions", suggestions);
                    _request = null;
                });
            });

            scope.$on('toggle-search', function() {
                scope.search.searchNavInput = '';
                scope.element.focus();
            })

        }

        postSearchContainer.$inject = ["$window"];

        function postSearchContainer(window) {
            var directive = {
                scope : true,
                link: {
                    post : link
                },
                controller : SearchContainerController
            };

            return directive;

            // - - -

            function link(scope, element) {
                widthCheck();

                angular.element(window).bind('resize', function() {
                    widthCheck();
                });

                function widthCheck() {
                    var width = element.innerWidth();
                    if (width < 768) {
                        element.find('.result-list').addClass('search-results-small');
                    }
                    else {
                        element.find('.result-list').removeClass('search-results-small');
                    }
                }
            }
        }

        SearchContainerController.$inject = ["$scope", "$timeout"]
        function SearchContainerController(scope, timeout, window) {

            scope.$on('clear-search-and-results', function() {
                timeout(function() {
                    scope.$broadcast('clear-search');
                }, 500)
            })

            scope.$on('toggle-search-visible', function() {
                scope.searchVisible = !scope.searchVisible;

                timeout(function() {
                    scope.$broadcast('toggle-search');
                }, 500)

            })

            scope.$on('post-search-get-suggestions', function() {
                scope.searchUpdating = true;
            })

            scope.$on('search-data-returned', function() {
                scope.searchUpdating = false;
            })

            // scope.$on('last-repeater-element', function() {
            //     timeout(function() {
            //         $(".gc-detail-title").dotdotdot({
            //             ellipsis: "...",
            //             height: "watch",
            //             keep: null,
            //             tolerance: 0,
            //             truncate: "word",
            //             watch: "window",
            //         });
            //     },500);
            // });
        }

        searchCard.$inject = ["$window"];

        function searchCard(window) {
            var directive = {
                scope : true,
                link : link
            };

            return directive;

            // - - -

            function link(scope, element)
            {
                var width;

                scope.getElementDimensions = function () {
                    return { 'h': element.height(), 'w': element.width() };
                };

                scope.$watch(scope.getElementDimensions, function (newValue, oldValue) {
                    if (newValue.w != oldValue.w)
                    {
                        width = newValue.w;
                        if (width < 345 && !element.hasClass('card-small')) {
                            element.addClass('card-small');
                        }
                        else if (width >= 345 && element.hasClass('card-small')) {
                            element.removeClass('card-small');
                        }
                    }
                }, true);

                element.bind('resize', function () {
                    scope.$apply();
                });
            }
        }

    })(window.angular);
</script>
<script type="text/javascript">
    (function(angular, $) {
        angular.module("nearMeModule", [])
            .directive("nearMeMap", nearMeMap)
        function nearMeMap()
        {
            var directive = {
                link : link,
                templateUrl: 'nearMe/map.html',
                scope: {
                    days: "@days",
                    distance: "@distance",
                    jsonurl: "@jsonurl",
                    mapId: "@mapId",
                    mapToken: "@mapToken",
                    face: "@face",
                    artist: "@artist",
                    type: "@type",
                    prompt: "@prompt"

                },
                controller: nearMeMapCtrl
            };

            return directive;

            function link(scope, element, attrs) {
                var mapToken = attrs.mapToken;
                var jsonurl = attrs.eventUrl;
                activate();

                function activate() {
                    // Request events near me
                    scope.$emit('get-events-near-me', jsonurl, mapToken);
                }

            }
        }
        nearMeMapCtrl.$inject = ["$scope", "$http"];

        function nearMeMapCtrl(scope, http) {

            scope.events = [];
            scope.anyEventClicked = false;
            scope.getEventsNearMe = getEventsNearMe;

            // var map = $('#' + scope.mapId);

            // console.log(1234, map.hide);


           /* scope.$on('get-events-near-me', function (evt, jsonurl, mapToken) {

                var map = $('#' + scope.mapId);
                http.get(jsonurl)
                    .then(function(res){
                        scope.searchingComplete = true;
                        map.show();
                        if (res.data.result.collection.length) {
                            // Load map of local area or whole US
                            var location = res.data.location ? [res.data.location.longitude, res.data.location.latitude] : ['-94.6708','38.9822'];
                            mapboxgl.accessToken = mapToken;

                            scope.map = new mapboxgl.Map({
                                container: scope.mapId,
                                style: 'mapbox://styles/mapbox/streets-v9',
                                center: location,
                                zoom: 6
                            })
                        } else {
                            map.hide();
                        }


                        handleEvents(res.data.result.collection);

                        // register click handler for markers added to map
                        angular.element('.marker').click(handleEventClicks);

                    })
                    .catch(function(err) {
                        scope.searchError = "Oops, something went wrong. " + err.data.error;
                        console.log('error', err);
                        map.hide();
                        scope.searchingComplete = true;
                    });
            })*/


           scope.onSuccess = onSuccess;
           scope.onError = onError;

            function onError(err) {
                scope.$apply(function(){
                    scope.refusedLocation = true;
                    scope.showRequest = false;
                })
            }

            function onSuccess(geoLoc) {

                var map = $('#' + scope.mapId);
                console.log('map', map);
                map.hide();
                scope.searchBegun = true;
                scope.showRequest = false;

                var params = {
                    days: scope.days,
                    distance: scope.distance,
                    latitude: geoLoc.coords.latitude,
                    longitude: geoLoc.coords.longitude
                };
                if (scope.type === 'face') {
                    params.face = scope.face;
                } else if (scope.type === 'artist') {
                    params.artist = scope.artist
                }


                http.get(scope.jsonurl, {params: params})
                    .then(function(res){
                        scope.searchingComplete = true;
                        if (res.data.result.collection.length) {

                            map.show();

                            var location = [geoLoc.coords.longitude, geoLoc.coords.latitude];

                            mapboxgl.accessToken = scope.mapToken;

                            scope.map = new mapboxgl.Map({
                                container: scope.mapId,
                                style: 'mapbox://styles/mapbox/streets-v9',
                                center: location,
                                zoom: 6
                            })
                        } else {
                            map.hide();
                        }


                        handleEvents(res.data.result.collection);

                        // register click handler for markers added to map
                        angular.element('.marker').click(handleEventClicks);

                    })
                    .catch(function(err) {
                        scope.searchError = "Oops, something went wrong. " + err.data.error;
                        console.log('error', err);
                        map.hide();
                        scope.searchingComplete = true;
                    });

            }


            function getEventsNearMe() {

                scope.showRequest = true;
                navigator.geolocation.getCurrentPosition(scope.onSuccess, scope.onError, {enableHighAccuracy: true});


            }

            function handleEvents(events) {
                $.each(events, function(index, event){
                    if (event) {
                        scope.events.push(parseEvent(event));
                    }
                })

                scope.events.forEach(function(event) {
                    putEventOnMap(event);
                })

            }

            function handleEventClicks() {
                var eventLocation = $(this).attr('data-event-location');

                scope.$apply(
                    function(scope){
                        scope.anyEventClicked = true;
                        scope.events.forEach(function(event) {
                            if (event.location.toString()  === eventLocation) {
                                event.clicked = true;
                            } else {
                                event.clicked = false;
                            }

                        })
                    }
                )
            }

            function zoomAndCenterMap(location, distance) {

                console.log('location', location);
                var params = {
                    center: [location.longitude, location.latitude],
                    zoom: 6
                }

                scope.map.flyTo(params)
            }

            function parseEvent(event) {
                var _event = {
                    name: event.title,
                    purchaseLink: "",
                    venue: event.venue,
                    location: [],
                    bestImage: "",
                    eventID: event.eventID
                }

                var atts = event.attributes;
                var venue = event.venue;
                if (venue)
                {
                    _event.venuestr = venue.name;

                    if (venue.location) {
                        _event.location = [venue.location.longitude, venue.location.latitude];
                        _event.city = venue.location.city;
                        _event.region = venue.location.region;
                        _event.country = venue.location.countryCode

                        console.log('venue.location', venue.location);

                        _event.locationStr = venue.location.city;

                        if (venue.location.region) {
                            _event.locationStr += ", " + venue.location.region;
                        }

                        else if (venue.location.countryCode) {
                            _event.locationStr += ", " + venue.location.countryCode;
                        }
                    }
                }

                if (event.gig) {
                    _event.date = event.gig.showTime;
                }

                if (event.bestImage)
                {
                    _event.bestImage = event.bestImage;
                }

                $.each(atts, function (key1, item) { // for each event attribute
                    if (item.key == "tmdiscovery.purchaseLink")
                    {
                        _event.purchaseLink = item.value;
                    }
                });

                return _event;

            }

            function putEventOnMap(event) {
                    var el = document.createElement('div');
                    el.className = 'marker';
                    el.style.backgroundColor = '#FFFFFF';
                    el.style.backgroundImage = 'url(' + event.bestImage +')';
                    el.style.width = '50px';
                    el.style.height = '50px';
                    el.style.borderRadius = '50%';
                    el.setAttribute('data-event-id', event.eventID)
                    el.setAttribute('data-event-location', event.location.toString());



                // // add marker to map
                    new mapboxgl.Marker(el)
                        .setLngLat(event.location)
                        .addTo(scope.map);

            }
        }


    })(angular, jQuery);
</script>
<script type="text/ng-template" id="nearMe/map.html">
    <div class="center" ng-hide="searchBegun">
        <div ng-show="showRequest">
            <i class="fas fa-spin fa-spinner fa-3x"></i>
            <h3>Please let your browser tell us where you are.</h3>
        </div>
        <div ng-hide="refusedLocation || showRequest">
            <h3>{{prompt}} <span ng-hide="prompt">Would you like to see the upcoming events in your area? </span></h3>
            <a href="#" class="btn btn-primary" ng-click="getEventsNearMe();">Find Events Near Me</a>
        </div>
        <p ng-show="refusedLocation">Geolocation is not enabled.  You can change your browser settings to let us find events near you.  </p>
    </div>
    <div ng-show="searchBegun">
        <div ng-attr-id="{{mapId}}" class="events-near-me-map"></div>

        <div class="text-center d-flex justify-content-center" ng-show="searchingComplete && !events.length">
            <h3  ng-show="!searchError" >No events near you within {{days}} days. </h3>
            <p  ng-show="searchingComplete" >{{searchError}}</p>

        </div>
        <div class="cards nearme mediaarticlelist">
            <div class="center" ng-hide="searchingComplete">
                <i class="fas fa-spin fa-spinner fa-3x"></i>
                <h3>Searching for events near you within {{days}} days.</h3>
            </div>
            <a ng-repeat="event in events" ng-href="{{event.purchaseLink}}" target="_blank" class="cardurl" ng-hide="anyEventClicked && !event.clicked">
                <div class="card p-2 m-1 m-md-2">
                    <div class="media">

                        <div class="media-body d-flex align-items-center text-left ml-1">
                            <div class="mr-2 mediacard-event-image">
                                <div style="background-image: url('{{event.bestImage}}')"></div>
                            </div>

                            <div class="mediacard-event-body">
                                <h4>{{event.locationStr}}</h4>
                                <div>{{event.date | date:longDate}}</div>
                                <div>{{event.venuestr}}</div>
                                <div>{{event.name}}</div>
                            </div>

                        </div>
                    </div>
                </div>
            </a>
        </div>
    </div>
</script>
<script type="text/javascript">
    (function(angular, $) {
        angular.module("eventsModule", [])
            .directive("eventList", eventList)
            .factory("eventService", eventService)

        eventService.$inject = ["$http", "$q"]

        function eventService(http, q) {
            var service = {
                getUpcomingArtistEvents: getUpcomingArtistEvents,
                getUpcomingVenueEvents: getUpcomingVenueEvents,
                getLocalEvents: getLocalEvents,
                getEventsByIP: getEventsByIP,
            };

            return service;

            // - - - public

            

            

            function getUpcomingArtistEvents(params, offset) {

                var url = '/p/dynamic/eventsforfavorites.do';
                params.showall = 1;

                
                return getRequest(url, params, offset);
            }

            function getUpcomingVenueEvents(params, offset) {
                var url = 'https://data.promogogo.com/p/events/upcoming.do';
                return getRequest(url, params, offset);
            }

            function getEventsByIP(params, offset) {
                var url = 'https://data.promogogo.com/p/events/location.do';
                
                return getRequest(url, params, offset);
            }

            function getLocalEvents(params, offset) {
                var url = 'https://data.promogogo.com/p/events/nearme.do';
                
                return getRequest(url, params, offset);
            }

            // - - - private

            function getRequest(url, params, offset) {
                var abort = q.defer();

                if (offset) {
                    params.offset = offset;
                }

                var requestObj = {
                    url : url,
                    params : params,
                    timeout : abort.promise,
                    method : "GET"
                };

                var request = http(requestObj);
                var promise = request.then(function(response) {
                    return response.data;
                });

                promise.abort = abort.resolve;
                promise.finally = function() {
                    promise.abort = angular.noop;
                    promise = abort = request = params = url = null;
                };

                return promise;
            }
        }

        function eventList()
        {
            var directive = {
                link : link,
                templateUrl: 'events/eventList.html',
                scope: {
                    listTitle: "@listTitle",
                    titleSize: "@titleSize",
                    listDisplay: "@listDisplay",
                    cardStyle: "@cardStyle",
                    eventSourceId: "@eventSourceId",
                    eventSourceType: "@eventSourceType",
                    titleSource: "@titleSource",
                    limitForLocation: "@limitForLocation",
                    line1Source: "@lineOneSource",
                    line2Source: "@lineTwoSource",
                    line3Source: "@lineThreeSource",
                    usePromoSpinner: "@usePromoSpinner",
                    eventsExtraGuid: "@eventsExtraGuid"
                },
                controller: EventListController
            };

            return directive;

            // - - -

            function link(scope, element, attrs) {
                // scope.$emit('get-events');
            }
        }

        EventListController.$inject = ["$scope", "eventService", "$filter"];

        function EventListController(scope, eventService, filter) {
            var MAX_LOCAL_LIST_LENGTH = 100;
            var upcomingOffset = "";
            var locationOffset = "";
            var end = false;
            var _ons = [];
            var mask = ""
            var request;
            var _upcoming = [];
            var _local = [];
            var locationSuccess = false;

            scope.searchingComplete = false;
            scope.locationDetail = {};
            scope.upcomingEvents = [];
            scope.localEvents = [];
            scope.eventListType = scope.eventSourceType==='location' ? 'local' : 'upcoming';
            scope.useUserLocation = true;


            scope.isVenue = scope.eventSourceType === 'venue' || (scope.eventSourceType === 'face' && mask === "venue");

            scope.showLocal = showLocal;
            scope.showUpcoming = showUpcoming;
            scope.getLocalEvents = getLocalEvents;
            scope.isLocationItemType = isLocationItemType;
            scope.isDateItemType = isDateItemType;
            scope.getItemType = getItemType;
            scope.getItemProp = getItemProp;
            scope.onLocationSuccess = onLocationSuccess;
            scope.onLocationError = onLocationError;
            scope.getEventsByDistance = getEventsByDistance;
            scope.getEventsByCity = getEventsByCity;
            scope.resetToLocal = resetToLocal;

            //this is needed on BPGo to trigger updates. Keep it to maintain compatability.
            _ons[0] = scope.$watch("eventSourceId", watchSourceIdType);
            _ons[1] = scope.$watch("eventSourceType", watchSourceIdType);
            _ons[2] = scope.$watch("titleSource", watchTitleSource);
            _ons[3] = scope.$on("get-new-event-list", watchSourceIdType);
            _ons[4]= scope.$on("$destroy", onDestroy);

            activate();

            // - - -

            function watchSourceIdType() {
                locationOffset = '';
                upcomingOffset = '';
                scope.upcomingEvents = [];
                scope.localEvents = [];
                _upcoming = [];
                _local = [];
                getEvents();
            }

            function watchTitleSource() {
                scope.upcomingEvents = _upcoming.map(parseEvent);
                scope.localEvents = _local.map(parseEvent);
            }

            function getEvents() {
                switch(scope.eventSourceType) {
                    case "face":
                    case "venue":
                        scope.eventListType = 'upcoming';
                        getUpcomingVenueEvents();
                        break;

                    case "artist":
                        scope.eventListType = 'upcoming';
                        getUpcomingArtistEvents();
                        break;

                    case "location":
                        scope.eventListType = 'local';
                        getEventsByIP();
                        break;

                    case "bucketgig":
                        scope.eventListType = 'upcoming';
                        getUpcomingArtistEvents();
                        break;

                    default:
                        console.warn("Unknown source type", scope.eventSourceType);
                }
            }

            function getUpcomingArtistEvents() {
                scope.searchingComplete = false;
                var params = getRequestParams();

                if (scope.eventsExtraGuid) {
                    params.eventsextra = scope.eventsExtraGuid;
                }
                if (request) request.abort();
                request = eventService.getUpcomingArtistEvents(params, upcomingOffset);

                request.then(function(data)
                {
                    var events = data.collection;
                    upcomingOffset = data.pagination.nextOffset;
                    end = data.pagination.end;

                    events.forEach(function(event) {
                        _upcoming.push(event);
                        scope.upcomingEvents.push(parseEvent(event));
                    });

                    if (upcomingOffset && !end) {
                        getUpcomingArtistEvents();
                    } else {
                        scope.searchingComplete = true;
                    }
                })
                    .catch(ignoreAbort)
                    .catch(function(err) {
                        scope.searchingComplete = true;
                        scope.upcomingError = true;
                        scope.errorMessage = err.data ? err.data.error : '';
                    });
            }

            function getUpcomingVenueEvents() {
                scope.searchingComplete = false;
                var params = getRequestParams();
                if (request) request.abort();
                request = eventService.getUpcomingVenueEvents(params, upcomingOffset);

                request.then(function(data)
                {
                    var events = data.collection;
                    upcomingOffset = data.pagination.nextOffset;
                    end = data.pagination.end;

                    events.forEach(function(event) {
                        _upcoming.push(event);
                        scope.upcomingEvents.push(parseEvent(event));
                    });

                    if (upcomingOffset && !end) {
                        getUpcomingVenueEvents();
                    } else {
                        scope.searchingComplete = true;
                    }
                })
                    .catch(ignoreAbort)
                    .catch(function(err) {
                        scope.searchingComplete = true;
                        scope.upcomingError = true;
                        scope.errorMessage = err.data ? err.data.error : '';
                    });
            }

            function getEventsByIP(distance) {
                scope.searchingComplete = false;
                var params = getRequestParams();

                if (distance) {
                    params.distance = distance;
                } else {
                    delete scope.distance;
                }

                if (limitedLocationResults()) {
                    params.limit = scope.limitForLocation;
                }
                if (request) request.abort();
                request = eventService.getEventsByIP(params, locationOffset);
                request.then(locationResponse)
                    .catch(ignoreAbort)
                    .catch(errorLocationResponse);
            }

            function getByLatLong(lat, long, distance) {
                scope.searchingComplete = false;
                scope.useLatLong = true;

                var params = getRequestParams();
                params.latitude = lat;
                params.longitude = long;

                if (distance) {
                    params.distance = distance;
                } else {
                    delete scope.distance;
                }

                if (request) request.abort();
                request = eventService.getLocalEvents(params, locationOffset);
                request.then(locationResponse)
                    .catch(ignoreAbort)
                    .catch(errorLocationResponse);
            }

            function locationResponse(data) {
                var result = data.result;
                var events = result.collection;
                locationOffset = result.pagination.nextOffset;
                end = result.pagination.end;
                scope.locationDetail = data.location;
                scope.distance = data.distance;

                events.forEach(function(event) {
                    _local.push(event);
                    scope.localEvents.push(parseEvent(event));
                });

                if (limitedLocationResults()) {
                    scope.searchingComplete = true;
                }
                else if (locationOffset && !end && scope.localEvents.length < MAX_LOCAL_LIST_LENGTH) {
                    getEventsByIP();
                } else {
                    scope.searchingComplete = true;
                }
            }

            function ignoreAbort(err) {
                if (err.status === -1) return;
                else throw err;
            }

            function errorLocationResponse(err) {
                scope.locationError = true;
                scope.errorMessage = err.data.error;
                scope.searchingComplete = true;
            }

            function showUpcoming (evt) {
                evt.preventDefault();
                scope.eventListType = 'upcoming';
            }

            function showLocal(evt) {
                evt.preventDefault();
                scope.eventListType = 'local';
                if (!scope.localEvents.length) {
                    getEventsByIP();
                }
            }

            function getLocalEvents() {
                scope.showRequest = true;
                scope.searchingComplete = false;
                navigator.geolocation.getCurrentPosition(scope.onLocationSuccess, scope.onLocationError, {enableHighAccuracy: true});
            }

            function resetToLocal() {
                _local = [];
                scope.localEvents = [];
                scope.useUserLocation = true;
                if (locationSuccess) {

                } else {
                    getEventsByIP();
                }
            }

            function getEventsByDistance(distance) {
                scope.distance = distance;
                scope.localEvents = [];
                _local = [];
                locationOffset = "";
                if (scope.useLatLong) {
                    getByLatLong(scope.lat, scope.long, distance);
                } else {
                    getEventsByIP(distance);
                }
            }

            function onLocationError(err) {
                locationSuccess = false;

                scope.$apply(function(){
                    scope.useLatLong = false;
                    scope.refusedLocation = true;
                    scope.showRequest = false;
                });
            }

            function onLocationSuccess(geoLoc) {
                scope.showRequest = false;
                var long = scope.long = geoLoc.coords.longitude;
                var lat = scope.lat = geoLoc.coords.latitude;

                scope.localEvents = [];
                _local = [];
                locationSuccess = true;
                getByLatLong(lat, long);

            }

            scope.cities = {
                amsterdam:      {lat: 52.35,        long: 4.916667,     name: "Amsterdam"},
                atlanta:        {lat: 33.74889,     long: -84.38806,    name: "Atlanta"},
                austin:         {lat: 30.26667,     long: -97.74278,    name: "Austin"},
                barcelona:      {lat: 41.38333,     long: 2.183333,     name: "Barcelona"},
                berlin:         {lat: 52.51667,     long: 13.4,         name: "Berlin"},
                boston:         {lat: 42.35806,     long: -71.06028,    name: "Boston"},
                chicago:        {lat: 41.8781136,   long: -87.6297982,  name: "Chicago"},
                copenhagen:     {lat: 55.66667,     long: 12.58333,     name: "Copenhagen"},
                dallas:         {lat: 32.7833333,   long: -96.8,         name: "Dallas"},
                dublin:         {lat: 53.353584,    long: -6.251495,    name: "Dublin"},
                houston:        {lat: 29.76306,     long: -95.36306,    name: "Houston"},
                /*
                                ibiza:          {lat: 38.90889,     long: 1.432778,     name: "Ibiza"},
                */
                london:         {lat: 51.509865,    long: -0.118092,    name: "London"},
                losAngeles:     {lat: 34.05222,     long: -118.2428,    name: "Los Angeles"},
                manchester:     {lat: 53.5,         long: -2.216667,    name: "Manchester"},
                melbourne:      {lat: -37.8167,     long: 144.9879,     name: "Melbourne"},
                memphis:        {lat: 35.14917,     long: -90.04889,    name: "Memphis"},
                miami:          {lat: 25.77389,     long: -80.19389,    name: "Miami"},
                nashville:      {lat: 36.1658333,   long: -86.7844444,  name: "Nashville"},
                newOrleans:     {lat: 29.95417,     long: -90.075,      name: "New Orleans"},
                newYork:        {lat: 40.71417,     long: -74.00639,    name: "New York"},
                orlando:        {lat: 28.53806,     long: -81.37917,    name: "Orlando"},
                paris:          {lat: 48.86667,     long: 2.333333,     name: "Paris"},
                sanFrancisco:   {lat: 37.775,       long: -122.4181,    name: "San Francisco"},
                seattle:        {lat: 47.60639,     long: -122.3306,    name: "Seattle"},
                stockholm:      {lat: 59.334591,    long: 18.063240,    name: "Stockholm"},
                sydney:         {lat: -33.88306,    long: 151.2167,     name: "Sydney"}
            }

            function getEventsByCity(cityName) {
                scope.useUserLocation = false;
                scope.localEvents = [];
                _local = [];

                var city = scope.cities[cityName];

                var long = scope.long = city.long;
                var lat = scope.lat = city.lat;

                getByLatLong(lat, long);
            }

            function getRequestParams () {
                var params = {
                    limit: 100
                };
                if (scope.eventSourceType === 'face') {
                    params.face = 'habbi';
                }

                if (scope.eventSourceType === 'artist') {
                    params.eventsextra = scope.eventsExtraGuid;
                    params.showall = true;
                    // params.artist =  scope.eventSourceId;

                }
                if (scope.eventSourceType === 'venue') {
                    params.venue = scope.eventSourceId;
                }
                if (scope.eventSourceType === 'bucketgig') {
                    params.faceguid = scope.eventSourceId;
                }
                return params;
            }

            function limitedLocationResults() {

                var limit = scope.limitForLocation || 0;

                if (scope.eventSourceType === 'location' && parseInt(limit)) {
                    return true;
                } else {
                    return false;
                }
            }

            function onDestroy() {
                _ons.forEach(function(d) {
                    d();
                });
            }

            function activate() {
                //getEvents();
            }

            function parseEvent(event) {
                var venue = event.venue  || event.gig.venue;

                return {
                    venuestr : venuestr(),
                    location : location(),
                    fields : fields(),
                    fieldTypes: fieldTypes(),
                    image : bestImage(),
                    purchaseLink : purchaseLink()
                };

                // - - -

                function venuestr() {
                    var venuestr;
                    if (venue)
                    {
                        venuestr = venue.name;
                    }
                    return venuestr;
                }

                function location() {
                    var location = [];
                    if (venue && venue.location)
                    {
                        location = [venue.location.longitude, venue.location.latitude];
                    }
                    return location;
                }

                function getDataBySource( source ) {
                    if (source === 'date') {
                        return filter('date')(event.gig.showTime, 'mediumDate')
                    }

                    if (source === 'city') {
                        var addressString = venue.location.city;

                        if (venue.location.region) {
                            addressString += ', ' + venue.location.region;
                        }

                        return addressString;
                    }

                    if (source === 'venue') {
                        return venue.name;
                    }

                    if (source === 'title') {
                        return event.title;
                    }
                }

                function fields() {

                    var fieldsByTitleSource = [
                        {type: "city", fields: {title: getDataBySource('city'), line1: getDataBySource('date'), line2: getDataBySource('venue'), line3: getDataBySource('title')}},
                        {type: "date", fields: {title: getDataBySource('date'), line1: getDataBySource('title'), line2: getDataBySource('venue'), line3: getDataBySource('city')}},
                        {type: "venue", fields: {title: getDataBySource('venue'), line1: getDataBySource('city'), line2: getDataBySource('title'), line3: getDataBySource('date')}},
                        {type: "title", fields: {title: getDataBySource('title'), line1: getDataBySource('date'), line2: getDataBySource('venue'), line3: getDataBySource('city')}}
                    ];

                    var fields = {
                        title: getDataBySource('city'),
                        line1: getDataBySource('date'),
                        line2: getDataBySource('venue'),
                        line3: getDataBySource('title')
                    };

                    if (scope.isVenue) {
                        fields = {
                            title: getDataBySource('title'),
                            line1: getDataBySource('date'),
                            line2: getDataBySource('venue'),
                            line3: getDataBySource('city')
                        }
                    }

                    if (scope.titleSource) {
                        var titleSourceObj = fieldsByTitleSource.find(function(src) {
                            return src.type === scope.titleSource;
                        });

                        fields = titleSourceObj.fields;
                    }
                    return fields;
                }

                function fieldTypes() {


                    var fieldTypesByTitleSource = [
                        {type: "city", fields: {title: 'city', line1: 'date', line2: 'venue', line3: 'title'}},
                        {type: "date", fields: {title: 'date', line1: 'title', line2: 'venue', line3: 'city'}},
                        {type: "venue", fields: {title: 'venue', line1: 'city', line2: 'title', line3: 'date'}},
                        {type: "title", fields: {title: 'title', line1: 'date', line2: 'venue', line3: 'city'}}
                    ];

                    var fieldTypes = {
                        title: 'city',
                        line1: 'date',
                        line2: 'venue',
                        line3: 'title'
                    };

                    if (scope.isVenue) {
                        fieldTypes = {
                            title: 'title',
                            line1: 'date',
                            line2: 'venue',
                            line3: 'city'
                        }
                    }

                    if (scope.titleSource) {
                        var titleSourceObj = fieldTypesByTitleSource.find(function(src) {
                            return src.type === scope.titleSource;
                        });

                        fieldTypes = titleSourceObj.fields;
                    }

                    return fieldTypes;
                }

                function bestImage() {
                    return event.bestImage;
                }



                function purchaseLink() {
                    var purchaseLink = event.purchaseLink;

                    if (!purchaseLink) {
                        $.each(event.attributes, function (key1, item) {
                            if (item.key == "tmdiscovery.purchaseLink")
                            {
                                purchaseLink = item.value;
                            }
                        });
                    }
                    return purchaseLink;
                }
            }


            /* Helper functions for adding schema properties.  Docs at: https://schema.org/Event */
            function isLocationItemType(field) {
                return field === 'city' || field === 'venue';
            }

            function isDateItemType(field) {
                return field === 'date'
            }

            function getItemType(field) {
                var itemType = "";
                if (isLocationItemType(field)) {
                    itemType = 'http://schema.org/Place';
                } else if (isDateItemType(field)) {
                    itemType = 'http://schema.org/Date';
                }

                return itemType;
            }

            function getItemProp(field) {
                var itemProp = "";
                if (field === 'venue') {
                    itemProp = 'name'; // use in Place schema
                } else if (field === 'city') {
                    itemProp = 'addressLocality';
                } else if (field === 'title') {
                    itemProp = 'name';
                } else if (field === 'date') {
                    itemProp = 'startDate';
                }

                return itemProp;
            }
        }

    })(angular, jQuery);
</script>
<script type="text/ng-template" id="events/eventList.html">
    <div class="border-top border-bottom border-light mb-5">
        <div ng-hide="isVenue">
            <div class="events-top-bar d-flex justify-content-between flex-row m-2 textstyletarget">
                <div class="flex-shrink-0">
                    <div class="d-flex flex-column align-items-center align-items-sm-start textstyletarget linkstyletarget">
                        <h1 class="m-auto">{{listTitle}}</h1>
                        <p ng-hide="eventSourceType==='location'" class="mb-1">
                            <a href="#" ng-class="[ 'events-list-menu', {selected: eventListType !== 'upcoming' }]" ng-click="showUpcoming($event)">All areas</a>&nbsp;|&nbsp;
                            <a href="#" ng-class="[ 'events-list-menu', {selected: eventListType === 'upcoming' }]" ng-click="showLocal($event)">Local</a>
                        </p>
                        <div ng-show="eventListType==='local' && upcomingEvents.length">
                            <div class="dropdown">
                                <button class="btn btn-primary btn-sm dropdown-toggle my-0"
                                        type="button" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                    <span ng-hide="useUserLocation">{{locationDetail.city || 'Select a city'}}</span>
                                    <span ng-show="useUserLocation">Select a city</span>
                                </button>
                                <div class="dropdown-menu scroll-menu">
                                    <a class="dropdown-item" href="#" ng-click="resetToLocal()">Your location</a>
                                    <a class="dropdown-item" ng-repeat="(cityKey, city) in cities" href="#" ng-click="getEventsByCity(cityKey)">{{city.name}}</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="ml-5" ng-show="eventListType==='local' || eventSourceType==='location' && upcomingEvents.length">
                    <div class="d-flex" ng-hide="useLatLong">
                        <div class="mr-2 mr-md-3" ng-show="locationDetail.city">
                            <div class="">
                                <i class="fas fa-map-marker fa-fw"></i>
                                <span>
                                    <strong>{{locationDetail.city}}</strong>
                                    <span class="d-none d-md-inline" ng-show="locationDetail.countryCode === 'us'">, {{locationDetail.regionName}}</span>
                                    <span class="d-none d-md-inline" ng-show="locationDetail.countryCode !== 'us'">, {{locationDetail.countryName}}</span>
                                </span>
                                <br />
                                <div class="smallertext center">from Internet address</div>
                            </div>
                        </div>
                        <div>
                            <a href="#" class="btn btn-sm btn-cta" ng-click="getLocalEvents()" ng-hide="refusedLocation"><span class="d-none d-md-inline">Locate Me</span><span class="d-md-none"><i class="fas fa-map-marker"></i></span></a>
                        </div>
                    </div>
                    <div class="d-flex flex-column align-items-center" ng-show="useLatLong">
                        <div ng-show="showRequest">
                            <h2>Will you let us know your current location? We use it to show you the events near you.</h2>
                        </div>
                        <p><i class="fas fa-map-marker"></i>
                            <span ng-show="locationDetail.city">
                                <strong>{{locationDetail.city}}</strong>
                            </span>
                            <span class="d-none d-md-inline" ng-show="locationDetail.countryCode === 'us'">, {{locationDetail.regionName}}</span>
                            <span class="d-none d-md-inline" ng-show="locationDetail.countryCode !== 'us'">, {{locationDetail.countryName}}</span>
                        </p>
                    </div>
                    <div class="w-100">
                        <div>Range: {{distance || '-'}} miles. <br class="d-md-none"/>
                            <a href="#" ng-show="!distance || distance < 500" ng-click="getEventsByDistance(500)" ng-cloak>I would walk 500 miles.</a>
                            <a href="#" ng-show="distance >= 500 && distance < 1000" ng-click="getEventsByDistance(1000)" ng-cloak>I would walk 500 more.</a>
                            <a href="#" ng-show="distance >= 1000" ng-click="getEventsByDistance()" ng-cloak>Reset</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div ng-class="['event-list-container', {'list-display-full':listDisplay==='full'}]">
            <div ng-show="eventListType === 'upcoming'">
                <div class="text-center d-flex justify-content-center" ng-show="searchingComplete && !upcomingEvents.length">
                    <h3 ng-hide="upcomingError && errorMessage" class="">No upcoming events found.</h3>
                    <h3 ng-show="upcomingError">{{errorMessage}}</h3>
                </div>
                <div ng-show="!upcomingEvents.length && !searchingComplete" class="d-flex justify-content-center">
                    <div class="text-center">
                        <span ng-show="usePromoSpinner">
                            <img class="fa-spin my-3" src="/styles/promogogo/promo_icon_120x128px.png" alt="Promogogo" />
                        </span>
                        <span ng-hide="usePromoSpinner">
                            <i class="fas fa-spinner fa-spin fa-2x"></i>
                        </span>
                        <p class="lead">Loading events ...</p>
                    </div>
                </div>
                <div>
                    <div>
                        <div class="articlecardlist d-md-flex justify-content-center"  ng-if="cardStyle === 'large'">
                            <div class="m-2" ng-repeat="event in upcomingEvents" ng-include="'events/largeEventCard.html'"></div>
                        </div>
                        <div class="cards mediaarticlelist" ng-if="cardStyle === 'medium'">
                            <div ng-repeat="event in upcomingEvents" ng-include="'events/mediumEventCard.html'"></div>
                        </div>

                        <div class="cards mediaarticlelist noimage" ng-if="cardStyle === 'noimage'" >
                            <div ng-repeat="event in upcomingEvents" ng-include="'events/noImageEventCard.html'"></div>
                        </div>

                        <div class="cards mediaarticlelist condensed" ng-if="cardStyle === 'small'">
                            <div ng-repeat="event in upcomingEvents" ng-include="'events/smallEventCard.html'"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div ng-show="eventListType === 'local'">
                <div ng-show="upcomingEvents.length && !searchingComplete" class="d-flex justify-content-center">
                    <div class="text-center"><i class="fas fa-spinner fa-spin fa-2x"></i>
                        <p>Loading events near you...</p>
                    </div>
                </div>
                <div class="text-center d-flex justify-content-center" ng-show="!localEvents.length && searchingComplete">
                    <div class="pc" ng-hide="locationError && errorMessage">We couldn't find any events near <span ng-show="locationDetail"><strong>{{locationDetail.city}}</strong><span ng-show="locationDetail.countryCode !== 'us'">, {{locationDetail.regionName}}</span></span></div>
                    <p ng-show="locationError">{{errorMessage}}</p>
                </div>
                <div ng-show="!localEvents.length && searchingComplete" >
                    <div ng-hide="!upcomingEvents.length">
                        <div class="articlecardlist d-md-flex justify-content-center"  ng-if="cardStyle === 'large'">
                            <div class="m-2" ng-repeat="event in upcomingEvents" ng-include="'events/largeEventCard.html'"></div>
                        </div>
                        <div class="cards mediaarticlelist" ng-if="cardStyle === 'medium'">
                            <div ng-repeat="event in upcomingEvents" ng-include="'events/mediumEventCard.html'"></div>
                        </div>

                        <div class="cards mediaarticlelist noimage" ng-if="cardStyle === 'noimage'" >
                            <div ng-repeat="event in upcomingEvents" ng-include="'events/noImageEventCard.html'"></div>
                        </div>

                        <div class="cards mediaarticlelist condensed" ng-if="cardStyle === 'small'">
                            <div ng-repeat="event in upcomingEvents" ng-include="'events/smallEventCard.html'"></div>
                        </div>
                    </div>
                </div>
                <div class="events-list">
                    <div>
                        <div class="articlecardlist d-md-flex justify-content-center"  ng-if="cardStyle === 'large'">
                            <div class="m-2" ng-repeat="event in localEvents" ng-include="'events/largeEventCard.html'"></div>
                        </div>
                        <div class="cards mediaarticlelist" ng-if="cardStyle === 'medium'">
                            <div ng-repeat="event in localEvents" ng-include="'events/mediumEventCard.html'"></div>
                        </div>

                        <div class="cards mediaarticlelist noimage" ng-if="cardStyle === 'noimage'" >
                            <div ng-repeat="event in localEvents" ng-include="'events/noImageEventCard.html'"></div>
                        </div>

                        <div class="cards mediaarticlelist condensed" ng-if="cardStyle === 'small'">
                            <div ng-repeat="event in localEvents" ng-include="'events/smallEventCard.html'"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>
<script type="text/ng-template" id="events/smallEventCard.html">
    <div class="card p-2 m-1 m-md-2" itemscope itemtype="http://schema.org/Event">
        <div class="media">
            <div class="d-flex w-100 align-items-center text-left justify-content-between">

                
                <h4 class="m-0 w-100 d-none d-md-block" ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.title) || isDateItemType(event.fieldTypes.title)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.title)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.title)}}">{{event.fields.title}}</span></h4>
                <div class="w-100 d-none d-md-block" ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line1) || isDateItemType(event.fieldTypes.line1)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line1)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line1)}}">{{event.fields.line1}}</span></div>
                <div class="w-100 d-none d-md-block" ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line2) || isDateItemType(event.fieldTypes.line2)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line2)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line2)}}">{{event.fields.line2}}</span></div>
                <div class="w-100 d-none d-md-block" ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line3) || isDateItemType(event.fieldTypes.line3)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line3)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line3)}}">{{event.fields.line3}}</span></div>
                <a class="btn btn-primary flex-shrink-1 flex-md-shrink-0 d-none d-md-block" ng-href="{{event.purchaseLink}}" ng-attr-position="{{event.fields.title}}" action="link" target="_blank"><i class="fas fa-ticket-alt text-white"></i></a>

                
                <div class="d-block d-md-none w-100">
                    <h4 class="m-0 w-100" ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.title) || isDateItemType(event.fieldTypes.title)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.title)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.title)}}">{{event.fields.title}}</span></h4>
                    <div class="w-100" ><span ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line1) || isDateItemType(event.fieldTypes.line1)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line1)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line1)}}">{{event.fields.line1}}</span></span> | <span ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line2) || isDateItemType(event.fieldTypes.line2)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line2)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line2)}}">{{event.fields.line2}}</span></span></div>
                    <div class="w-100" ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line3) || isDateItemType(event.fieldTypes.line3)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line3)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line3)}}">{{event.fields.line3}}</span></div>
                </div>

                <a class="btn btn-primary flex-shrink-1 flex-md-shrink-0 d-md-none btn-sm ctatrackandsend" ng-href="{{event.purchaseLink}}"  ng-attr-position="(e): {{event.fields.title}}" action="link" itemprop="url" target="_blank"><i class="fas fa-ticket-alt text-white"></i></a>

            </div>
        </div>
    </div>
</script>
<script type="text/ng-template" id="events/noImageEventCard.html">
    <div itemscope itemtype="http://schema.org/Event">
        <a ng-href="{{event.purchaseLink}}" target="_blank"  ng-attr-position="(e): {{event.fields.title}}" action="link" class="cardurl ctatrackandsend" itemprop="url" >
            <div class="card p-2 m-1 m-md-2">
                <div class="media">
                    <div class="media-body d-flex  align-items-center text-left ml-1">
                        <div class="">
                            <h4 class="m-0" ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.title) || isDateItemType(event.fieldTypes.title)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.title)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.title)}}">{{event.fields.title}}</span></h4>
                            <p ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line1) || isDateItemType(event.fieldTypes.line1)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line1)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line1)}}">{{event.fields.line1}}</span></p>
                            <div ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line2) || isDateItemType(event.fieldTypes.line2)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line2)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line2)}}">{{event.fields.line2}}</span></div>
                            <div ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line3) || isDateItemType(event.fieldTypes.line3)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line3)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line3)}}">{{event.fields.line3}}</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </a>
    </div>
</script>
<script type="text/ng-template" id="events/mediumEventCard.html">
    <div itemscope itemtype="http://schema.org/Event">
        <a ng-href="{{event.purchaseLink}}" target="_blank" ng-attr-position="(e): {{event.fields.title}}" action="link" class="cardurl ctatrackandsend" itemprop="url" >
            <div class="card p-2 m-1 m-md-2">
                <div class="media">
                    <div class="media-body d-flex align-items-center text-left ml-1">
                        <div class="mr-2 d-flex text-white mediacard-event-image flex-shrink-0">
                            <div ng-style="{'background-image': 'url(' + event.image + ')'}">
                                <span ng-show="loading"><i class="fas fa-spinner fa-spin fa-3x"></i></span>
                            </div>
                        </div>
                        <div class="mediacard-event-body">
                            <h4 ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.title) || isDateItemType(event.fieldTypes.title)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.title)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.title)}}">{{event.fields.title}}</span></h4>
                            <div ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line1) || isDateItemType(event.fieldTypes.line1)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line1)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line1)}}">{{event.fields.line1}}</span></div>
                            <div ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line2) || isDateItemType(event.fieldTypes.line2)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line2)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line2)}}">{{event.fields.line2}}</span></div>
                            <div ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line3) || isDateItemType(event.fieldTypes.line3)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line3)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line3)}}">{{event.fields.line3}}</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </a>
    </div>

</script>
<script type="text/ng-template" id="events/largeEventCard.html" itemscope itemtype="http://schema.org/Event">
    <a ng-href="{{event.purchaseLink}}" target="_blank" ng-attr-position="(e): {{event.fields.title}}" action="link" class="cardurl m-0 ctatrackandsend" ng-cloak itemprop="url">
        <div class="card">
            <div class="card-image" ng-style="{'background-image': 'url(' + event.image + ')', 'background-position': 'center', 'background-size': 'cover'}"></div>
            <div class="card-body">
                <h4 class="card-title" ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.title) || isDateItemType(event.fieldTypes.title)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.title)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.title)}}">{{event.fields.title}}</span></h4>
                <p class="card-text">
                <div ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line1) || isDateItemType(event.fieldTypes.line1)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line1)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line1)}}">{{event.fields.line1}}</span></div>
                <div ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line2) || isDateItemType(event.fieldTypes.line2)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line2)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line2)}}">{{event.fields.line2}}</span></div>
                <div ng-attr-itemscope="{{isLocationItemType(event.fieldTypes.line3) || isDateItemType(event.fieldTypes.line3)}}" ng-attr-itemtype="{{getItemType(event.fieldTypes.line3)}}"><span ng-attr-itemprop="{{getItemProp(event.fieldTypes.line3)}}">{{event.fields.line3}}</span></div>
                </p>
            </div>
        </div>
    </a>
</script>
<script>
    angular.module("app", ["showloginmodule", "postsearch.module", "nearMeModule", "eventsModule"]);
</script>
<script>
    (function (angular)
    {
        'use strict';
        var appModule = angular.module('appModule', []);

        appModule.filter('capitalize', function() {
            return function(input, all) {
                var reg = (all) ? /([^\W_]+[^\s-]*) */g : /([^\W_]+[^\s-]*)/;
                return (!!input) ? input.replace(reg, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();}) : '';
            }
        });

        appModule.directive('proxySrc', proxySrc);

        function constructProxyUrl(url, attrs)
        {
            var param = {};

            if( attrs.proxyWidth ) {
                param.width = attrs.proxyWidth;
            }
            if( attrs.proxyHeight ) {
                param.height = attrs.proxyHeight;
            }
            if( attrs.proxySize ) {
                param.size = attrs.proxySize;
            }

            //image has to be last so complex urls (like Eventbrite) with their own params don't get corrupt
            var src = "/imageproxy/s3?" + $.param(param) + "&image=" + url.replace("http://", "https://");

            return src;
        }

        /**
         * @desc Funnel img src attribute to image proxy. http will be converted to https.
         *
         * @usage <img proxy-src="http://mine.is/image.jpg" proxy-width="60" proxy-size="square"/>
         *
         **/

        function proxySrc()
        {
            var directive = {
                link : link,
                scope : {
                    proxySrc : "@proxySrc"
                }
            };

            return directive;

            // - - -

            function link(scope, element, attrs) {
                update();

                scope.$watch("proxySrc", update);

                function update() {
                    var url = scope.proxySrc;

                    // Setting display to `null` is unpredictable. In case of the photo widget, it stays 'none'.

                    /* element.css({
                     display : !!url ? null : "none"
                     }); */

                    if( url ) {
                        var src = constructProxyUrl(url, attrs);
                        element.attr("src", src);
                    }
                }
            }
        }
    })(angular);
</script>
<script type="text/ng-template" id="search/result/list.html">
    <div class="search-result">
        <div class="input-spinner m-2 center" ng-show="status.busy"><i class="fas fa-spin fa-spinner fa-3x"></i></div>
        <ul style="padding-left: 0; list-style-type: none;">
            <li ng-repeat="item in items" ng-click="selectItem(item)"></li>
        </ul>
    </div>
</script>
<script type="text/ng-template" id="search/result/venue.html">
    <a class="search-item" ng-cloak>
        <div class="img">
            <img https-src="{{item.imageURL}}" ng-show="item.imageURL">
            <i class="fas fa-map-marker" ng-hide="item.imageURL"></i>
        </div>
        <div class="info">
            <p class="title">{{item.name}}</p>
            <p class="info" ng-show="match.model.tier">Tier {{item.tier}}</p>
            <p class="address">{{ item.address1 }}</p>
            <p class="source" ng-show="item.location.city">
                {{ item.location.city }}
                {{ item.location.region ? ', ' + item.location.region : '' }}
            </p>
        </div>
    </a>
</script>
<script type="text/ng-template" id="search/result/artist.html">
    <a class="search-item" ng-cloak>
        <div class="img">
            <img https-src="{{item.imageurl}}" ng-show="item.imageurl">
            <i class="fas fa-user" ng-hide="item.imageurl"></i>
        </div>
        <div class="info">
            <p class="title">{{item.displayname}}</p>
            <p class="info" ng-show="item.tier">Tier {{item.tier}}</p>
        </div>
    </a>
</script>
<script type="text/ng-template" id="search/result/event.html">
    <a class="search-item" ng-cloak>
        <div class="img">
            <img https-src="{{item.imageurl}}" ng-show="item.imageurl">
            <i class="fas fa-map-marker" ng-hide="item.imageurl"></i>
        </div>
        <div class="info">
            <p class="title">{{item.displayname}}</p>
            <p class="info" ng-show="item.tier">Tier {{item.tier}}</p>
            <p class="address">{{ item.address1 }}</p>
            <p class="source" ng-show="item.location.city">
                {{ item.location.city }}
                {{ item.location.region ? ', ' + item.location.region : '' }}
            </p>
        </div>
    </a>
</script>
<script type="text/javascript">
    (function ()
    {
        'use strict';

        angular.module("search.module", [])
                .factory("search.service", searchService)
                .directive("gogoSearchInput", searchInputDirective)

        searchService.$inject = ["$http", "$q"];

        function searchService(http, q) {
            var service = {
                getSearchRequest : getSearchRequest
            };

            return service;

            // - - -

            function getSearchRequest(entry, attrs) {
                var url = attrs.requestBaseUrl;
                var params = eval("("+attrs.requestFixedParameters+")") || {};
                params[attrs.requestSearchParameter] = entry;
                var abort = q.defer();

                // create a generic request object
                var requestObj = {
                    url: url,
                    params : params,
                    timeout : abort.promise,
                    method: 'GET',
                    data: attrs.requestData
                };

                // allow for configuration to POST data or set headers
                var requestConfig = eval("(" + attrs.requestConfig + ")") || {};
                for (var key in requestConfig) {
                    requestObj[key] = requestConfig[key];
                }
                var request = http(requestObj);
                var promise = request
                    .then(function(response) {

                        // checks if mapping will resolve

                        function checkMapping(mapping, base) {
                            if (!mapping) return false;
                            var path = mapping.split('.');
                            for ( var i = 0; i < path.length; i++ ) {
                                if (base[path[i]]) {
                                    base = base[path[1]];
                                } else {
                                    return false;
                                }
                                return true;
                            }
                        }

                        // default is returning the responose data
                        var suggestions = response.data;

                        var wholeResponse = response.data; // adds property for the whole response

                        // use response-mapping attribute to map to a different property
                        if( checkMapping(attrs.responseMapping, response.data) ) {  // check if responseMapping will resolve, not just whether there is a responseMapping attr.
                            suggestions = eval( "response.data." + attrs.responseMapping );
                        }


                        return {suggestions : suggestions, response: wholeResponse};  // return object with suggestions and the whole response
                    }, function (error)
                    {
                        // we end up here on abort, so return an empty list
                        return {suggestions: [], wholeResponse: {}}; // mirrors successfull response without data.
                    });
                promise.abort = function ()
                {
                    abort.resolve();
                };

                promise.finally = function ()
                {
                    //cleanup
                    promise.abort = angular.noop;
                    promise = abort = request = params = url = null;
                };

                return promise;
            }
        }

        searchInputDirective.$inject = ["$compile", "$templateCache"];

        function searchInputDirective(compile, cache)
        {
            var directive = {
                scope : true,
                link : link,
                controller : SearchController
            };

            return directive;

            // - - -

            function link(scope, element, attrs)
            {
                scope.items = [];
                scope.$list = null;
                scope.status = {
                    busy : false,
                    ready : false,
                    limit : 0
                };

                activate();

                scope.searchOnChange = function(model) {
                    if( model.length > scope.status.limit ) {
                        if ( scope.page ) {scope.page.searchpage = 1;}
                        if ( scope.offset ) {scope.offset.curr = 0}
                        search();
                    }
                }
                //                element.on("keyup", function() {
                //                    if( this.value.length > scope.status.limit ) {
                //                        if ( scope.page ) {scope.page.searchpage = 1;}
                //                        if ( scope.offset ) {scope.offset.curr = 0}
                //                        search();
                //                    }
                //                });

                scope.$on('gogo-begin-search', function(event) {
                    if (element[0].value.length > scope.status.limit) {
                        search();
                    }
                });

                scope.$on('gogo-begin-update', function(event, ready) {
                    scope.status.ready = ready;
                    update();
                });

                scope.$on("gogo-search-suggestions", function(evt, responseData) {
                    scope.items = responseData.suggestions;
                    scope.$emit('search-data-returned', responseData.response, attrs); // emits whole response from search and attributes
                    scope.status.ready = responseData.suggestions.length > 0;
                    scope.status.busy = false;

                    scope.$emit("status-busy-change", scope.status.busy);
                    update();
                });

                scope.selectItem = function(item) {
                    scope.status.ready = false;
                    update();
                    var expr = attrs.selectedItem;
                    if( expr ) {
                        scope.tmpSearchSelctedItemXYZ = item;
                        expr += "=tmpSearchSelctedItemXYZ";
                        scope.$eval(expr);
                        delete scope.tmpSearchSelctedItemXYZ;
                    }
                    scope.$emit("gogo-search-item", item);
                };

                function update() {
                    scope.$list
                            .css({
                                     display : scope.status.ready ? "block" : "none"
                                 });
                }

                function search() {
                    scope.status.busy = true;
                    scope.$eval(attrs.selectedItem + "=null");
                    scope.$emit("gogo-search-get-suggestions", element.val() );
                    scope.$emit("status-busy-change", scope.status.busy);
                }

                function activate() {
                    scope.status.limit = parseInt(attrs.inputLimit) || 0;
                    var result = $(cache.get("search/result/list.html"));
                    if( attrs.inputSpinner === "false" ) {
                        result.find(".input-spinner").remove();
                    }
                    var list = scope.$list = result.find("ul");
                    list.addClass(attrs.resultClass ? attrs.resultClass : "dropdown-menu");
                    var template = $(cache.get(attrs.resultTemplateUrl));
                    var li = list.find("li");
                    li.append(template);
                    element.parent().append(result);
                    compile(result)(scope);

                    scope.$emit("gogo-search-view-ready", attrs);
                    if( attrs.requestSearchValue ) {
                        element.val(attrs.requestSearchValue);
                        search();
                    }
                }
            }
        }

        SearchController.$inject = ["$scope", "search.service"];

        function SearchController(scope, service) {
            var _attrs = {}, _request = null;

            scope.$on("gogo-search-view-ready", function(evt, attrs) {
                _attrs = attrs;
            });

            scope.$on("gogo-search-get-suggestions", function(evt, entry) {
                if( _request ) {
                    _request.abort();
                }
                (_request = service.getSearchRequest(entry, _attrs)).then(function(suggestions) {
                    scope.$broadcast("gogo-search-suggestions", suggestions);
                    //_request = null;
                });
            });
        }
    })();
</script>
<script type="text/ng-template" id="search/result/gogo.html">
    <a class="gogo-search-item pmd" ng-cloak ng-click="search.mode === 'venue' ? selectToPromote(item.locationID, item.name, true) : selectToPromote(item.id, item.displayname, false)">
        <div ng-if="search.mode==='venue'" ng-cloak>

            <div class="pmd-img pmd-img-mainimg" >
                <img class="img-fluid" proxy-src="{{item.bestImage}}"  proxy-width="120" ng-if="item.bestImage">
                <i class="fas fa-map-marker" ng-if="!item.bestImage" ></i>
            </div>
            <div class="pmd-bd">
                <p class="pmd-bd-title">{{item.name}}</p>
                <div class="">
                    
                    <p class="address">{{ item.address1 }}</p>
                        <p class="source" ng-show="item.location.city">
                            {{ item.location.city }}
                            {{ item.location.region ? ', ' + item.location.region : '' }}
                        </p>
                </div>

            </div>
        </div>

        <div ng-if="search.mode==='artist'" ng-cloak>
                <div class="pmd-img pmd-img-mainimg" >
                    <img class="img-fluid" proxy-src="{{item.imageurl}}"  proxy-width="120"ng-if="item.imageurl">
                    <i class="fas fa-user" ng-hide="item.imageurl" ></i>
                </div>
                <div class="pmd-bd">
                    <p class="pmd-bd-title">{{item.displayname}}</p>
                    <span class="info" ng-show="item.tier">Tier {{item.tier}}</span>
                    <span>{{item.genre | capitalize}}</span>
                </div>
        </div>
        </a>

</script>
<script type="text/javascript">
    (function(angular)
    {
        angular.module("tmsearch.module", [])
                .directive('gogoSearch', gogoSearchDirective)
                .controller('GeneralSearchCtrl', GeneralSearchController);

        GeneralSearchController.$inject = ['$scope', "$element", "$http", "$timeout", "$filter"];

        function GeneralSearchController(scope, element, http, timeout, filter)
        {
            scope.changeOffset = changeOffset;
            scope.changePage = changePage;
            scope.changeSearch = changeSearch;
            scope.clear = clear;
            scope.connectThirdParty = connectThirdParty;
            scope.getInitOffset = getInitOffset;
            scope.normalizePagination = normalizePagination;
            scope.selectToPromote = selectToPromote;
            scope.updateSearch = updateSearch;
            scope.$on('search-data-returned', function (event, data, attrs)
            {
                if (data)
                {
                    scope.wholeResponse = data;
                    normalizePagination(attrs);
                }
            });

            scope.$on("status-busy-change", function(evt, busyStatus) {
                scope.statusBusy = busyStatus
            })

            function changePage(curr, change, last)
            {
                var updated = curr;
                if (change === 'first')
                {
                    updated = 1;
                }
                else if (change === 'prev' && curr > 1)
                {
                    updated = curr - 1;
                }
                else if (change === 'next' && curr < last)
                {
                    updated = curr + 1;
                }
                else if (change === 'last' && last)
                {
                    updated = last;
                }
                return updated;
            }

            function changeOffset(offset, change)
            {
                if (change === 'first')
                {
                    offset.curr = 0;
                }
                else if (change === 'next')
                {
                    var upperLimit = scope.totalPages ? scope.totalPages - 1 : Math.round(scope.totalItems / scope.pageSize) || null;
                    if (upperLimit && offset.curr < upperLimit)
                    {
                        if (!offset.key[offset.curr + 1])
                        {
                            offset.key[offset.curr + 1] = scope.nextOffset
                        }
                        offset.curr++;
                    }
                }
                else if (change === 'prev')
                {
                    if (offset.curr > 0)
                    {
                        offset.curr--;
                    }

                }

                return offset;
            }

            function changeSearch(event)
            {
                var disabled = element.find(event.currentTarget).hasClass('disabled');
                if (disabled) return;
                timeout(function ()
                        {
                            scope.$broadcast('gogo-begin-search')
                        });
            }

            function clear() {
                scope.search.artist = null;
                scope.search.venue = null;
                scope.search.event = null;
                scope.search.idToPromote = '';
                scope.search.nameToPromote = '';

                scope.$emit('search-item-cleared');
            }

            function connectThirdParty($event, type, id, internalId, source)
            {
                var target = element.find($event.currentTarget);
                var originalMessage = target.html();
                target.html('<i class="fas fa-spinner"></i>');

                var params = {
                    pgg: internalId ? 1 : 0,
                    source: source
                };
                params[type] = id;
                var request = {
                    url: '/go/promogogo/follow3rdpartyintimeline.do',
                    method: 'GET',
                    params: params
                };

                http(request)
                    .then(function(res) {
                        if (res.data.err || res.data.error) throw {error: res.data.err || res.data.error};
                        target.removeClass('err-following');
                        scope.$broadcast('third-party-followed', target, originalMessage);
                    })
                    .catch(function(err) {
                        console.error(err);
                        var errorMessage = '<div class="alert alert-danger alert-dismissable" role="alert">' +
                                           '<button class="close" data-dismiss="alert"><i class="fas fa-times"></i></button>' +
                                           'Oops. Something went wrong adding ' + type + '. Error: ' + err.error +'</div>'
                        element.prepend(errorMessage);
                        target.html(originalMessage);
                    })
            }

            function evaluateMapping(pathStr, base)
            {
                if (!base || !pathStr) return false;
                var path = pathStr.split('.');
                for (var i = 0; i < path.length; i++)
                {
                    if (base[path[i]])
                    {
                        base = base[path[1]];
                    }
                    else
                    {
                        return false;
                    }
                    return true;
                }
            }

            function getInitOffset(offset, first)
            {
                offset = {
                    key: [first], curr: 0
                };
                return offset;
            }

            function normalizePagination(attrs)
            {
                scope.currentPage = evaluateMapping(attrs.currentPageMapping, scope.wholeResponse) ? eval("scope.wholeResponse." + attrs.currentPageMapping) : null;
                scope.totalPages = evaluateMapping(attrs.totalPagesMapping, scope.wholeResponse) ? eval("scope.wholeResponse." + attrs.totalPagesMapping) : null;
                scope.pageSize = evaluateMapping(attrs.pageSizeMapping, scope.wholeResponse) ? eval("scope.wholeResponse." + attrs.pageSizeMapping) : null;
                scope.totalItems = evaluateMapping(attrs.totalItemsMapping, scope.wholeResponse) ? eval("scope.wholeResponse." + attrs.totalItemsMapping) : null;
                scope.nextOffset = evaluateMapping(attrs.nextOffsetMapping, scope.wholeResponse) ? eval("scope.wholeResponse." + attrs.nextOffsetMapping) : null;
            }

            function selectToPromote(id, name, type) {
                console.log(id, name, type);
                scope.search.idToPromote = id;
                scope.search.nameToPromote = name;
                scope.search.isVenue = type ? 1 : 0;

                scope.$emit('search-item-selected');
            }

            function updateSearch(ready)
            {
                timeout(function ()
                        {
                            scope.$broadcast('gogo-begin-update', ready);
                        });
            }
        }

        function gogoSearchDirective() {
            var directive = {
                scope: true, link: link
            };

            return directive;

            function link(scope, element, attrs)
            {
                scope.$on('third-party-followed', function (evt, target, original)
                {
                    if (target.hasClass('btn'))
                    {
                        target.addClass('disabled');
                        target.html('<i class="fas fa-check"></i> Now connected');
                    }
                });
            }
        }
    })(window.angular);

</script>
<script>
    (function() {
        var logIn = angular.module('loginRegisterModule', []);

        logIn.controller('loginRegisterController', LoginRegisterController);

        LoginRegisterController.$inject = ["$scope", "$element"];
        function LoginRegisterController(scope, element) {
            scope.getDimensions = getDimensions;
            scope.changeForm = changeForm;

            scope.disableSignupSubmit = true;

            scope.$on('search-item-selected', function() {
                scope.disableSignupSubmit = false;
            });

            scope.$on('search-item-cleared', function() {
                scope.disableSignupSubmit = true;
            });

            function getDimensions () {
                scope.signUpHeight = scope.signUpHeight || element[0].offsetHeight + 'px';
                scope.signUpWidth = element[0].offsetWidth + 'px';

                scope.animateDimensions = {
                    'min-height': scope.signUpHeight
                }

            }


            function changeForm (newForm) {
                    scope.login.currentForm = newForm;
            }


            scope.login = {currentForm : 'signUp'};
        }
    })();

</script>
<script type="text/javascript">
        (function (angular) {
            angular.module("showloginmodule", ["appModule", "search.module", "tmsearch.module", "loginRegisterModule", "ngAnimate", /*"grindr.subscribe.module"*/]);
        })(angular);
    </script>
<script src="/scripts/promogogo/tracking/pgtrackpageviews.js?version=20190221T013654000Z" type="text/javascript" data-faceurl="habbi" data-instance="promogogo"></script>
<script type="text/javascript" src="/scripts/3rdparty/mdb/mdbbpro/js/mdb.min.js"></script>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"errorBeacon":"bam.nr-data.net","licenseKey":"48bd10419e","agent":"","beacon":"bam.nr-data.net","applicationTime":438,"applicationID":"3627290","transactionName":"ZgZRZkpSCxJWVBYLWV9MYEZKRhESdlQWC1lfTFBdVR0IDlVeDgtCRBAdRV1RAxNYWRZMV1IXWl1WHRUTWFoNBVlWDB1gXV0BBEVzGwxXXApQc1ZdChRZVAcPU18XclFMWgoP","queueTime":0}</script></body>
</html>